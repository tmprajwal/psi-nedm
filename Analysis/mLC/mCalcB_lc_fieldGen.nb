(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    101803,       2670]
NotebookOptionsPosition[     98646,       2562]
NotebookOutlinePosition[     99020,       2578]
CellTagsIndexPosition[     98977,       2575]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Pre-calc      ", "Chapter",
 CellChangeTimes->{{3.6955037984439726`*^9, 3.6955038070535393`*^9}, {
  3.6955038493251486`*^9, 3.6955038503942766`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OS", "=", "\"\<win\>\""}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"or", " ", "linux"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<EDA`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<CustomTicks`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"OS", "\[Equal]", "\"\<win\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Working Directory: \>\"", ",", 
       RowBox[{"curDir", "=", 
        RowBox[{
        "SetDirectory", "[", 
         "\"\<C:\\\\Users\\\\Prajwal\\\\Dropbox\\\\nEDM\\\\psi-nedm\\\\\
Analysis\\\\mLC\>\"", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<(ASCII) Rawdata Directory: \>\"", ",", 
       RowBox[{
       "AscDir", "=", 
        "\"\<C:\\\\Users\\\\Prajwal\\\\Dropbox\\\\nEDM\\\\rawdata\>\""}]}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"OS", "\[Equal]", "\"\<linux\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Working Directory:\>\"", ",", 
       RowBox[{"curDir", "=", 
        RowBox[{
        "SetDirectory", "[", 
         "\"\</home/prajwal/Dropbox/nEDM/psi-nedm/Analysis\>\"", "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<(faster) Rawdata Directory:\>\"", ",", 
       RowBox[{"fastDir", "=", "\"\</home/prajwal/nEDM/rawdata\>\""}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<(ASCII) Rawdata Directory:\>\"", ",", 
       RowBox[{
       "AscDir", "=", "\"\</home/prajwal/Dropbox/nEDM/rawdata\>\""}]}], "]"}],
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", ".12"}], ";", 
  RowBox[{"h", "=", ".0054"}], ";", 
  RowBox[{"b", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"4", " ", 
      SuperscriptBox["h", "2"]}], "+", 
     SuperscriptBox["H", "2"]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      SuperscriptBox["h", "2"], " ", "H"}], "+", 
     SuperscriptBox["H", "3"]}]]}], ";", 
  RowBox[{"cylr", "=", ".235"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mu0", "=", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "7"}]], "\[Times]", "2", "\[Pi]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "r", "]"}]}], "Input",
 CellChangeTimes->{{3.695510273212858*^9, 3.6955102775594063`*^9}, {
   3.695652243784697*^9, 3.6956522671223*^9}, {3.696152700135008*^9, 
   3.6961527110047827`*^9}, {3.6961528040571675`*^9, 
   3.6961528158599567`*^9}, {3.6961559425779076`*^9, 3.6961559428570585`*^9}, 
   3.696589673756728*^9, {3.69658973317157*^9, 3.6965897662267127`*^9}, {
   3.698062537224777*^9, 3.6980625376770616`*^9}, {3.6983564551668825`*^9, 
   3.698356462638563*^9}, {3.6983622424659157`*^9, 3.698362244979163*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Working Directory: \"\>", 
   "\[InvisibleSpace]", \
"\<\"C:\\\\Users\\\\Prajwal\\\\Dropbox\\\\nEDM\\\\psi-nedm\\\\Analysis\\\\mLC\
\"\>"}],
  SequenceForm[
  "Working Directory: ", 
   "C:\\Users\\Prajwal\\Dropbox\\nEDM\\psi-nedm\\Analysis\\mLC"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6965897445542984`*^9, 3.6965897671429396`*^9}, 
   3.696708471762605*^9, 3.69670853282796*^9, 3.6978664060160913`*^9, 
   3.697896535800771*^9, 3.697906285882591*^9, {3.698062518919265*^9, 
   3.6980625388677835`*^9}, 3.6980632017910275`*^9, 3.698356463971597*^9, 
   3.6983622458217597`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"(ASCII) Rawdata Directory: \"\>", 
   "\[InvisibleSpace]", \
"\<\"C:\\\\Users\\\\Prajwal\\\\Dropbox\\\\nEDM\\\\rawdata\"\>"}],
  SequenceForm[
  "(ASCII) Rawdata Directory: ", "C:\\Users\\Prajwal\\Dropbox\\nEDM\\rawdata"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6965897445542984`*^9, 3.6965897671429396`*^9}, 
   3.696708471762605*^9, 3.69670853282796*^9, 3.6978664060160913`*^9, 
   3.697896535800771*^9, 3.697906285882591*^9, {3.698062518919265*^9, 
   3.6980625388677835`*^9}, 3.6980632017910275`*^9, 3.698356463971597*^9, 
   3.698362245827264*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lattice Generation", "Chapter",
 CellChangeTimes->{{3.6960724760255923`*^9, 3.696072481873248*^9}, {
  3.6961472149777546`*^9, 3.6961472187073193`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"nn", "=", 
     RowBox[{
     "number", " ", "of", " ", "total", " ", "lattice", " ", "points"}]}], 
    ",", " ", 
    RowBox[{"hh", "=", 
     RowBox[{"height", " ", "of", " ", "cyclinder"}]}], ",", " ", 
    RowBox[{"rr", "=", 
     RowBox[{"radius", " ", "of", " ", "cylinder"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Returns", " ", "number", " ", "of", " ", "lattice", " ", "points", " ", 
     "not", " ", "equal", " ", "to", " ", "nn"}], ",", " ", 
    RowBox[{
     RowBox[{"but", " ", "nearly", " ", "nn"}], ";", " ", 
     RowBox[{
     "lattice", " ", "points", " ", "themselves", " ", "in", " ", "2", "D", 
      " ", "array"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tmP01", "=", 
     RowBox[{
      RowBox[{"Timing", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"qq", "=", ".008"}], ";", "\[IndentingNewLine]", 
        RowBox[{"cyl", "=", 
         RowBox[{"ImplicitRegion", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"]}], "<", 
               SuperscriptBox["cylr", "2"]}], ")"}], "&&", 
             RowBox[{"z", ">", "0"}], "&&", 
             RowBox[{"z", "<", "H"}]}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"-", "cylr"}], ",", "cylr"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"-", "cylr"}], ",", "cylr"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"z", ",", "0", ",", "H"}], "}"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Parallelize", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dscrtcyl", "=", 
           RowBox[{"DiscretizeRegion", "[", 
            RowBox[{"cyl", ",", 
             RowBox[{"MeshQualityGoal", "\[Rule]", "1"}], ",", 
             RowBox[{"MaxCellMeasure", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<Length\>\"", "\[Rule]", "qq"}], "}"}]}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"latticepts", "=", 
           RowBox[{"MeshCoordinates", "[", "dscrtcyl", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"qq", "\[GreaterEqual]", ".02"}], ",", 
            RowBox[{"Print", "[", "dscrtcyl", "]"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Size of the homogeneous lattice = \>\"", ",", " ", 
          RowBox[{"Dimensions", "[", "latticepts", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dimlattice", "=", 
         RowBox[{
          RowBox[{"Dimensions", "[", "latticepts", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
       "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{
     "1.", " ", "Time", " ", "Scaling", " ", "to", " ", "compute", " ", 
      "lattice", " ", "points"}], ",", " ", 
     RowBox[{
     "4", " ", "cores", "\[IndentingNewLine]", "2.", " ", "Write", " ", "the",
       " ", "lattice", " ", "points", " ", "to", " ", "file"}]}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<*) # lattice points = \>\"", ",", "dimlattice", ",", 
      "\"\<; Time taken to generate lattice points with {cell side length (m) \
= \>\"", ",", "qq", ",", 
      "\"\<, cell volume (\!\(\*SuperscriptBox[\(m\), \(3\)]\)): \>\"", ",", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"(", "qq", ")"}], "^", "3"}], "]"}], ",", "\"\<} = \>\"", ",",
       "tmP01", ",", "\"\< s\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<*) Increase # of lattice points by a factor, ptscl = \>\"", ",", 
      RowBox[{"ptscl", "=", "100"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<*) # lattice points = \>\"", ",", 
      RowBox[{"dimlattice", "*", "ptscl"}], ",", 
      "\"\<; Time taken to generate lattice points with {cell side length (m) \
= \>\"", ",", 
      RowBox[{"qq", "/", 
       RowBox[{"CubeRoot", "[", "ptscl", "]"}]}], ",", 
      "\"\<, cell volume (\!\(\*SuperscriptBox[\(m\), \(3\)]\)): \>\"", ",", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "qq", ")"}], "^", "3"}], "/", "ptscl"}], "]"}], ",", 
      "\"\<} = \>\"", ",", 
      RowBox[{"tmP01", "*", "ptscl"}], ",", "\"\< s\>\""}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<*) Descrease lattice side length (qq) by a factor, sdscl = \>\"", 
      ",", 
      RowBox[{"sdscl", "=", "5"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<*) # lattice points = \>\"", ",", 
      RowBox[{"dimlattice", "*", 
       RowBox[{"sdscl", "^", "3"}]}], ",", 
      "\"\<; Time taken to generate lattice points with {cell side length (m) \
= \>\"", ",", 
      RowBox[{"qq", "/", "sdscl"}], ",", 
      "\"\<, cell volume (\!\(\*SuperscriptBox[\(m\), \(3\)]\)): \>\"", ",", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"qq", "/", "sdscl"}], ")"}], "^", "3"}], "]"}], ",", 
      "\"\<} = \>\"", ",", 
      RowBox[{"tmP01", "*", 
       RowBox[{"sdscl", "^", "3"}]}], ",", "\"\< s\>\""}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<*) Mean of the lattice distribution [ideally around ({0,0,.06} \
\[PlusMinus] \>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"2", "/", 
         RowBox[{"(", 
          RowBox[{"cylr", "*", "dimlattice"}], ")"}]}], "]"}], ",", 
       RowBox[{"N", "[", 
        RowBox[{"2", "/", 
         RowBox[{"(", 
          RowBox[{"cylr", "*", "dimlattice"}], ")"}]}], "]"}], ",", 
       RowBox[{"N", "[", 
        RowBox[{"2", "/", 
         RowBox[{"(", 
          RowBox[{"H", "*", "dimlattice"}], ")"}]}], "]"}]}], "}"}], ",", 
     "\"\<)m, cntr = \>\"", ",", 
     RowBox[{"cntr", " ", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"latticepts", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Mean", "[", 
         RowBox[{"latticepts", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Mean", "[", 
         RowBox[{"latticepts", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "3"}], "]"}], "]"}], "]"}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<lattice_pts.dat\>\"", ",", "latticepts"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6961473263497596`*^9, 3.6961473417289343`*^9}, {
   3.6961485104192524`*^9, 3.69614851315864*^9}, {3.6961485484076843`*^9, 
   3.6961486924818964`*^9}, {3.6961487437809606`*^9, 3.69614881568715*^9}, {
   3.696149643238177*^9, 3.6961496476063375`*^9}, {3.69614968086947*^9, 
   3.6961499783978896`*^9}, {3.696150051498239*^9, 3.69615010607436*^9}, {
   3.69615050555398*^9, 3.6961505089362392`*^9}, {3.696150548756465*^9, 
   3.696150558472548*^9}, {3.6961543922611475`*^9, 3.69615447382381*^9}, {
   3.6961545473997355`*^9, 3.6961545949184732`*^9}, {3.696154887783527*^9, 
   3.6961549981952853`*^9}, {3.6961550341456933`*^9, 3.6961550443292847`*^9}, 
   3.696155270086997*^9, 3.6961559704586725`*^9, 3.6961560186026993`*^9, 
   3.6961565620744743`*^9, 3.696156932602681*^9, 3.6961578087609043`*^9, {
   3.6961584389764147`*^9, 3.696158498173268*^9}, {3.6961585757347536`*^9, 
   3.6961585760470967`*^9}, {3.6961705074281197`*^9, 3.696170584391636*^9}, {
   3.696171677321319*^9, 3.696171677550172*^9}, {3.696595367621001*^9, 
   3.696595437549076*^9}, {3.696602949682141*^9, 3.696602950967598*^9}, 
   3.696707421029756*^9, {3.6967084909324317`*^9, 3.6967084921349845`*^9}, {
   3.6967154675155354`*^9, 3.6967155345965605`*^9}, {3.696715619317442*^9, 
   3.696715655472648*^9}, {3.6967157242620096`*^9, 3.6967157255569305`*^9}, {
   3.6967157734562674`*^9, 3.696715792366432*^9}, {3.696715923640312*^9, 
   3.696715934887992*^9}, {3.696716009503559*^9, 3.6967160460541563`*^9}, {
   3.696718150291998*^9, 3.6967181506032443`*^9}, {3.696721955726553*^9, 
   3.696721987805073*^9}, 3.6978998536040154`*^9, {3.6979012637426205`*^9, 
   3.697901263972754*^9}, {3.697906265985835*^9, 3.6979062667994413`*^9}, {
   3.6983565004252777`*^9, 3.69835650066967*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Size of the homogeneous lattice = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"30701", ",", "3"}], "}"}]}],
  SequenceForm["Size of the homogeneous lattice = ", {30701, 3}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6961585881531134`*^9, 3.696170477637743*^9, 3.6961705241747456`*^9, {
   3.696170563653782*^9, 3.6961706041176233`*^9}, 3.6961716895888724`*^9, 
   3.6965859733840327`*^9, 3.696595380150566*^9, 3.6965954275045757`*^9, 
   3.696595481262581*^9, 3.6966029653055973`*^9, 3.696708510783553*^9, 
   3.696715544473035*^9, 3.6967156386966486`*^9, 3.6967156708901176`*^9, 
   3.696715738673379*^9, {3.6967157880332813`*^9, 3.696715812502963*^9}, 
   3.696715971692932*^9, 3.6967160855340347`*^9, 3.6967181904491806`*^9, {
   3.6967219767417607`*^9, 3.6967220031109476`*^9}, 3.6978664520826497`*^9, 
   3.697899865962718*^9, 3.697901274186291*^9, {3.6979062808675127`*^9, 
   3.6979063080449605`*^9}, 3.698062571254627*^9, 3.6980632291208134`*^9, 
   3.6983565321822977`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"*) # lattice points = \"\>", "\[InvisibleSpace]", "30701", 
   "\[InvisibleSpace]", "\<\"; Time taken to generate lattice points with \
{cell side length (m) = \"\>", "\[InvisibleSpace]", "0.008`", 
   "\[InvisibleSpace]", "\<\", cell volume (\\!\\(\\*SuperscriptBox[\\(m\\), \
\\(3\\)]\\)): \"\>", "\[InvisibleSpace]", "5.12`*^-7", 
   "\[InvisibleSpace]", "\<\"} = \"\>", "\[InvisibleSpace]", "14.25`", 
   "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "*) # lattice points = ", 30701, 
   "; Time taken to generate lattice points with {cell side length (m) = ", 
   0.008, ", cell volume (\!\(\*SuperscriptBox[\(m\), \(3\)]\)): ", 5.12*^-7, 
   "} = ", 14.25, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6961585881531134`*^9, 3.696170477637743*^9, 3.6961705241747456`*^9, {
   3.696170563653782*^9, 3.6961706041176233`*^9}, 3.6961716895888724`*^9, 
   3.6965859733840327`*^9, 3.696595380150566*^9, 3.6965954275045757`*^9, 
   3.696595481262581*^9, 3.6966029653055973`*^9, 3.696708510783553*^9, 
   3.696715544473035*^9, 3.6967156386966486`*^9, 3.6967156708901176`*^9, 
   3.696715738673379*^9, {3.6967157880332813`*^9, 3.696715812502963*^9}, 
   3.696715971692932*^9, 3.6967160855340347`*^9, 3.6967181904491806`*^9, {
   3.6967219767417607`*^9, 3.6967220031109476`*^9}, 3.6978664520826497`*^9, 
   3.697899865962718*^9, 3.697901274186291*^9, {3.6979062808675127`*^9, 
   3.6979063080449605`*^9}, 3.698062571254627*^9, 3.6980632291208134`*^9, 
   3.698356532188303*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"*) Increase # of lattice points by a factor, ptscl = \"\>", 
   "\[InvisibleSpace]", "100"}],
  SequenceForm["*) Increase # of lattice points by a factor, ptscl = ", 100],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6961585881531134`*^9, 3.696170477637743*^9, 3.6961705241747456`*^9, {
   3.696170563653782*^9, 3.6961706041176233`*^9}, 3.6961716895888724`*^9, 
   3.6965859733840327`*^9, 3.696595380150566*^9, 3.6965954275045757`*^9, 
   3.696595481262581*^9, 3.6966029653055973`*^9, 3.696708510783553*^9, 
   3.696715544473035*^9, 3.6967156386966486`*^9, 3.6967156708901176`*^9, 
   3.696715738673379*^9, {3.6967157880332813`*^9, 3.696715812502963*^9}, 
   3.696715971692932*^9, 3.6967160855340347`*^9, 3.6967181904491806`*^9, {
   3.6967219767417607`*^9, 3.6967220031109476`*^9}, 3.6978664520826497`*^9, 
   3.697899865962718*^9, 3.697901274186291*^9, {3.6979062808675127`*^9, 
   3.6979063080449605`*^9}, 3.698062571254627*^9, 3.6980632291208134`*^9, 
   3.698356532194806*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"*) # lattice points = \"\>", "\[InvisibleSpace]", "3070100", 
   "\[InvisibleSpace]", "\<\"; Time taken to generate lattice points with \
{cell side length (m) = \"\>", "\[InvisibleSpace]", "0.0017235477520255072`", 
   "\[InvisibleSpace]", "\<\", cell volume (\\!\\(\\*SuperscriptBox[\\(m\\), \
\\(3\\)]\\)): \"\>", "\[InvisibleSpace]", "5.1200000000000005`*^-9", 
   "\[InvisibleSpace]", "\<\"} = \"\>", "\[InvisibleSpace]", "1425.`", 
   "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "*) # lattice points = ", 3070100, 
   "; Time taken to generate lattice points with {cell side length (m) = ", 
   0.0017235477520255072`, 
   ", cell volume (\!\(\*SuperscriptBox[\(m\), \(3\)]\)): ", 
   5.1200000000000005`*^-9, "} = ", 1425., " s"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6961585881531134`*^9, 3.696170477637743*^9, 3.6961705241747456`*^9, {
   3.696170563653782*^9, 3.6961706041176233`*^9}, 3.6961716895888724`*^9, 
   3.6965859733840327`*^9, 3.696595380150566*^9, 3.6965954275045757`*^9, 
   3.696595481262581*^9, 3.6966029653055973`*^9, 3.696708510783553*^9, 
   3.696715544473035*^9, 3.6967156386966486`*^9, 3.6967156708901176`*^9, 
   3.696715738673379*^9, {3.6967157880332813`*^9, 3.696715812502963*^9}, 
   3.696715971692932*^9, 3.6967160855340347`*^9, 3.6967181904491806`*^9, {
   3.6967219767417607`*^9, 3.6967220031109476`*^9}, 3.6978664520826497`*^9, 
   3.697899865962718*^9, 3.697901274186291*^9, {3.6979062808675127`*^9, 
   3.6979063080449605`*^9}, 3.698062571254627*^9, 3.6980632291208134`*^9, 
   3.6983565322012887`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"*) Descrease lattice side length (qq) by a factor, sdscl = \
\"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm[
  "*) Descrease lattice side length (qq) by a factor, sdscl = ", 5],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6961585881531134`*^9, 3.696170477637743*^9, 3.6961705241747456`*^9, {
   3.696170563653782*^9, 3.6961706041176233`*^9}, 3.6961716895888724`*^9, 
   3.6965859733840327`*^9, 3.696595380150566*^9, 3.6965954275045757`*^9, 
   3.696595481262581*^9, 3.6966029653055973`*^9, 3.696708510783553*^9, 
   3.696715544473035*^9, 3.6967156386966486`*^9, 3.6967156708901176`*^9, 
   3.696715738673379*^9, {3.6967157880332813`*^9, 3.696715812502963*^9}, 
   3.696715971692932*^9, 3.6967160855340347`*^9, 3.6967181904491806`*^9, {
   3.6967219767417607`*^9, 3.6967220031109476`*^9}, 3.6978664520826497`*^9, 
   3.697899865962718*^9, 3.697901274186291*^9, {3.6979062808675127`*^9, 
   3.6979063080449605`*^9}, 3.698062571254627*^9, 3.6980632291208134`*^9, 
   3.698356532210291*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"*) # lattice points = \"\>", "\[InvisibleSpace]", "3837625", 
   "\[InvisibleSpace]", "\<\"; Time taken to generate lattice points with \
{cell side length (m) = \"\>", "\[InvisibleSpace]", "0.0016`", 
   "\[InvisibleSpace]", "\<\", cell volume (\\!\\(\\*SuperscriptBox[\\(m\\), \
\\(3\\)]\\)): \"\>", "\[InvisibleSpace]", "4.096`*^-9", 
   "\[InvisibleSpace]", "\<\"} = \"\>", "\[InvisibleSpace]", "1781.25`", 
   "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "*) # lattice points = ", 3837625, 
   "; Time taken to generate lattice points with {cell side length (m) = ", 
   0.0016, ", cell volume (\!\(\*SuperscriptBox[\(m\), \(3\)]\)): ", 
   4.096*^-9, "} = ", 1781.25, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6961585881531134`*^9, 3.696170477637743*^9, 3.6961705241747456`*^9, {
   3.696170563653782*^9, 3.6961706041176233`*^9}, 3.6961716895888724`*^9, 
   3.6965859733840327`*^9, 3.696595380150566*^9, 3.6965954275045757`*^9, 
   3.696595481262581*^9, 3.6966029653055973`*^9, 3.696708510783553*^9, 
   3.696715544473035*^9, 3.6967156386966486`*^9, 3.6967156708901176`*^9, 
   3.696715738673379*^9, {3.6967157880332813`*^9, 3.696715812502963*^9}, 
   3.696715971692932*^9, 3.6967160855340347`*^9, 3.6967181904491806`*^9, {
   3.6967219767417607`*^9, 3.6967220031109476`*^9}, 3.6978664520826497`*^9, 
   3.697899865962718*^9, 3.697901274186291*^9, {3.6979062808675127`*^9, 
   3.6979063080449605`*^9}, 3.698062571254627*^9, 3.6980632291208134`*^9, 
   3.6983565322187967`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"*) Mean of the lattice distribution [ideally around ({0,0,.06} \
\[PlusMinus] \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.00027721045887340283`", ",", "0.00027721045887340283`", ",", 
     "0.0005428704819604139`"}], "}"}], 
   "\[InvisibleSpace]", "\<\")m, cntr = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0004268152615496569`", ",", "0.0002457272724381703`", ",", 
     "0.06003234406814803`"}], "}"}]}],
  SequenceForm[
  "*) Mean of the lattice distribution [ideally around ({0,0,.06} \
\[PlusMinus] ", {0.00027721045887340283`, 0.00027721045887340283`, 
   0.0005428704819604139}, ")m, cntr = ", {0.0004268152615496569, 
   0.0002457272724381703, 0.06003234406814803}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6961585881531134`*^9, 3.696170477637743*^9, 3.6961705241747456`*^9, {
   3.696170563653782*^9, 3.6961706041176233`*^9}, 3.6961716895888724`*^9, 
   3.6965859733840327`*^9, 3.696595380150566*^9, 3.6965954275045757`*^9, 
   3.696595481262581*^9, 3.6966029653055973`*^9, 3.696708510783553*^9, 
   3.696715544473035*^9, 3.6967156386966486`*^9, 3.6967156708901176`*^9, 
   3.696715738673379*^9, {3.6967157880332813`*^9, 3.696715812502963*^9}, 
   3.696715971692932*^9, 3.6967160855340347`*^9, 3.6967181904491806`*^9, {
   3.6967219767417607`*^9, 3.6967220031109476`*^9}, 3.6978664520826497`*^9, 
   3.697899865962718*^9, 3.697901274186291*^9, {3.6979062808675127`*^9, 
   3.6979063080449605`*^9}, 3.698062571254627*^9, 3.6980632291208134`*^9, 
   3.698356532228303*^9}]
}, Open  ]],

Cell[BoxData["\<\"lattice_pts.dat\"\>"], "Output",
 CellChangeTimes->{3.69671581515635*^9, 3.6967159942396555`*^9, 
  3.6967161076042814`*^9, 3.696718193086542*^9, 3.696721976732235*^9, 
  3.696722008048908*^9, 3.697866457171747*^9, 3.69789986863008*^9, 
  3.697901274831745*^9, 3.6979062810501423`*^9, 3.697906313078506*^9, 
  3.6980625772402015`*^9, 3.6980632349877768`*^9, 3.6983565370811424`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Field Elements", "Chapter",
 CellChangeTimes->{{3.6960724760255923`*^9, 3.696072481873248*^9}, {
  3.696171941819893*^9, 3.6961719430500536`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bl", "[", 
    RowBox[{"i_", ",", "x_", ",", "y_", ",", "z_", ",", "l_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Quiet", "[", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
       RowBox[{
        FractionBox[
         RowBox[{"i", " ", "mu0"}], 
         RowBox[{"4", " ", "\[Pi]"}]], 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            FractionBox["l", "2"], "-", "z"}], 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                FractionBox["l", "2"], "-", "z"}], ")"}], "2"]}]]], "+", 
          FractionBox[
           RowBox[{
            FractionBox["l", "2"], "+", "z"}], 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                FractionBox["l", "2"], "+", "z"}], ")"}], "2"]}]]]}], ")"}], 
        FractionBox["1", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}]], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "y"}], ",", "x", ",", "0"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], "/.", 
      RowBox[{"Indeterminate", "\[Rule]", "0"}]}], "]"}], "/.", 
    RowBox[{"ComplexInfinity", "\[Rule]", "0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  SqrtBox[
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    SuperscriptBox["y", "2"]}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bc", "[", 
    RowBox[{"i_", ",", "x_", ",", "y_", ",", "z_", ",", "rr_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Quiet", "[", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
       RowBox[{
        FractionBox[
         RowBox[{"i", " ", "mu0", " ", "2", " ", "z"}], 
         RowBox[{"4", "\[Pi]", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["rr", "2"], "+", 
            SuperscriptBox[
             RowBox[{"r", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
            RowBox[{"2", "rr", " ", 
             RowBox[{"r", "[", 
              RowBox[{"x", ",", "y"}], "]"}]}], "+", 
            SuperscriptBox["z", "2"]}]]}]], 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"x", "\[Times]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"EllipticK", "[", 
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{"4", " ", 
                   RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], " ", "rr"}], 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
                   RowBox[{"2", "  ", 
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "rr"}], "+", 
                   SuperscriptBox["rr", "2"], "+", 
                   SuperscriptBox["z", "2"]}]]}], "]"}], 
               SuperscriptBox[
                RowBox[{"r", "[", 
                 RowBox[{"x", ",", "y"}], "]"}], "2"]]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"EllipticE", "[", 
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{"4", " ", 
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], " ", "rr"}], 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}]}], "+", "rr"}], ")"}], 
                    "2"], "+", 
                    SuperscriptBox["z", "2"]}]]}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "2"], "+", 
                  SuperscriptBox["rr", "2"], "+", 
                  SuperscriptBox["z", "2"]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], 
                   SuperscriptBox[
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "2"], "rr"}], "+", 
                  RowBox[{
                   RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], 
                   SuperscriptBox["rr", "2"]}], "+", 
                  RowBox[{
                   RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}], ")"}], 
              "/", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"r", "[", 
                  RowBox[{"x", ",", "y"}], "]"}], "3"], 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["rr", "4"], "-", 
                  RowBox[{"2", 
                   SuperscriptBox["rr", "2"], 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}], "2"]}], ")"}]}], 
               ")"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"y", "\[Times]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"EllipticK", "[", 
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{"4", " ", 
                   RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], " ", "rr"}], 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
                   RowBox[{"2", "  ", 
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "rr"}], "+", 
                   SuperscriptBox["rr", "2"], "+", 
                   SuperscriptBox["z", "2"]}]]}], "]"}], 
               SuperscriptBox[
                RowBox[{"r", "[", 
                 RowBox[{"x", ",", "y"}], "]"}], "2"]]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"EllipticE", "[", 
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{"4", " ", 
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], " ", "rr"}], 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}]}], "+", "rr"}], ")"}], 
                    "2"], "+", 
                    SuperscriptBox["z", "2"]}]]}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "2"], "+", 
                  SuperscriptBox["rr", "2"], "+", 
                  SuperscriptBox["z", "2"]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], 
                   SuperscriptBox[
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "2"], "rr"}], "+", 
                  RowBox[{
                   RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], 
                   SuperscriptBox["rr", "2"]}], "+", 
                  RowBox[{
                   RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}], ")"}], 
              "/", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"r", "[", 
                  RowBox[{"x", ",", "y"}], "]"}], "3"], 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["rr", "4"], "-", 
                  RowBox[{"2", 
                   SuperscriptBox["rr", "2"], 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
                    SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "2"], "+", 
                    SuperscriptBox["z", "2"]}], ")"}], "2"]}], ")"}]}], 
               ")"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"EllipticE", "[", 
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"4", " ", 
                  RowBox[{"r", "[", 
                   RowBox[{"x", ",", "y"}], "]"}], " ", "rr"}], 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}]}], "+", "rr"}], ")"}], 
                   "2"], "+", 
                  SuperscriptBox["z", "2"]}]]}], "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"r", "[", 
                  RowBox[{"x", ",", "y"}], "]"}], "rr"}], "-", 
                SuperscriptBox["rr", "2"], "-", 
                SuperscriptBox["x", "2"], "-", 
                SuperscriptBox["y", "2"], "-", 
                SuperscriptBox["z", "2"]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"r", "[", 
                  RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
                SuperscriptBox["rr", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"EllipticK", "[", 
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"4", " ", 
                  RowBox[{"r", "[", 
                   RowBox[{"x", ",", "y"}], "]"}], " ", "rr"}], 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}]}], "+", "rr"}], ")"}], 
                   "2"], "+", 
                  SuperscriptBox["z", "2"]}]]}], "]"}], 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["rr", "4"], "-", 
                RowBox[{"2", 
                 SuperscriptBox["rr", "2"], 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
                   SuperscriptBox["z", "2"]}], ")"}]}], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "2"], "+", 
                   SuperscriptBox["z", "2"]}], ")"}], "2"]}], ")"}]}]}], 
            ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"z", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["rr", "4"], "-", 
               RowBox[{"2", 
                SuperscriptBox["rr", "2"], 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
                  SuperscriptBox["z", "2"]}], ")"}]}], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "2"], "+", 
                  SuperscriptBox["z", "2"]}], ")"}], "2"]}], ")"}]}], 
            ")"}]}]}], "\[IndentingNewLine]", "}"}]}], " ", 
       "\[IndentingNewLine]", "]"}], "/.", 
      RowBox[{"Indeterminate", "\[Rule]", "0"}]}], "]"}], "/.", 
    RowBox[{"ComplexInfinity", "\[Rule]", "0"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6960725527673407`*^9, 3.6960725997279687`*^9}, {
   3.696072631655716*^9, 3.6960726716644735`*^9}, {3.6960729671908035`*^9, 
   3.696073087253337*^9}, {3.696073232437007*^9, 3.6960732414816628`*^9}, {
   3.6960732920899715`*^9, 3.6960733677928452`*^9}, {3.696073778821136*^9, 
   3.696073871613082*^9}, {3.6960739076421537`*^9, 3.6960742306645923`*^9}, {
   3.696074274352667*^9, 3.6960743053146353`*^9}, {3.6960744206834474`*^9, 
   3.696074552850648*^9}, {3.6960747828764086`*^9, 3.696074954246993*^9}, {
   3.6960750149283466`*^9, 3.696075049608216*^9}, {3.696075090978166*^9, 
   3.696075141729692*^9}, {3.696078808854642*^9, 3.6960788140524197`*^9}, {
   3.696152705899433*^9, 3.696152706670545*^9}, {3.696714314872735*^9, 
   3.6967143633060308`*^9}, {3.696715222337553*^9, 3.696715278285986*^9}, {
   3.696716445771284*^9, 3.6967164992982893`*^9}, {3.6967186285848875`*^9, 
   3.6967186423813376`*^9}, {3.6967203277663345`*^9, 3.69672033761847*^9}, {
   3.696720399938166*^9, 3.696720419965105*^9}, 3.696720684869012*^9, {
   3.6967208978597393`*^9, 3.696720940639536*^9}, {3.6983632075517225`*^9, 
   3.698363209354024*^9}, {3.6983632502676964`*^9, 3.6983632520953946`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Geometry+Field", "Chapter",
 CellChangeTimes->{{3.6960724760255923`*^9, 3.696072481873248*^9}, {
  3.696171941819893*^9, 3.696171957245058*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"bl", "[", 
     RowBox[{"i", ",", "x", ",", "y", ",", "z", ",", "l"}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"bc", "[", 
     RowBox[{"i", ",", "x", ",", "y", ",", "z", ",", "rr"}], "]"}], 
    "\[IndentingNewLine]", "1.", " ", "loop1", "\[IndentingNewLine]", "2.", 
    " ", "Straight1", "\[IndentingNewLine]", "2", 
    RowBox[{"b", ".", " ", "Slant1"}], "\[IndentingNewLine]", "3.", " ", 
    "Arc1"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ii", "=", 
     RowBox[{"100", "\[Times]", 
      SuperscriptBox["10", 
       RowBox[{"-", "12"}]]}]}], ";", 
    RowBox[{"del", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "3"}]]}], 
    RowBox[{"(*", 
     SuperscriptBox["10", 
      RowBox[{"-", "12"}]], "*)"}], ";", 
    RowBox[{"del2", "=", 
     RowBox[{"cylr", "/", "3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"b1", "[", 
      RowBox[{"x", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}], ".."}], "}"}]}], "]"}], ":=", 
     RowBox[{"b1", "/@", "x"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"b1", "[", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"b1x", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{"ii", ",", "x", ",", 
            RowBox[{"z", "-", "H", "-", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", "x", ",", 
            RowBox[{"y", "-", "cylr", "-", "del"}], ",", 
            RowBox[{"z", "-", 
             RowBox[{"(", 
              RowBox[{"H", "/", "2"}], ")"}]}], ",", "H"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", "x", ",", 
            RowBox[{"z", "+", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"bc", "[", 
           RowBox[{"ii", ",", "x", ",", "y", ",", 
            RowBox[{"z", "-", 
             RowBox[{"(", 
              RowBox[{"H", "/", "2"}], ")"}]}], ",", 
            RowBox[{"cylr", "+", "del"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b1y", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{"ii", ",", "x", ",", 
            RowBox[{"z", "-", "H", "-", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", "x", ",", 
            RowBox[{"y", "-", "cylr", "-", "del"}], ",", 
            RowBox[{"z", "-", 
             RowBox[{"(", 
              RowBox[{"H", "/", "2"}], ")"}]}], ",", "H"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", "x", ",", 
            RowBox[{"z", "+", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"bc", "[", 
           RowBox[{"ii", ",", "x", ",", "y", ",", 
            RowBox[{"z", "-", 
             RowBox[{"(", 
              RowBox[{"H", "/", "2"}], ")"}]}], ",", 
            RowBox[{"cylr", "+", "del"}]}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b1z", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{"ii", ",", "x", ",", 
            RowBox[{"z", "-", "H", "-", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", "x", ",", 
            RowBox[{"y", "-", "cylr", "-", "del"}], ",", 
            RowBox[{"z", "-", 
             RowBox[{"(", 
              RowBox[{"H", "/", "2"}], ")"}]}], ",", "H"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", "x", ",", 
            RowBox[{"z", "+", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"bc", "[", 
           RowBox[{"ii", ",", "x", ",", "y", ",", 
            RowBox[{"z", "-", 
             RowBox[{"(", 
              RowBox[{"H", "/", "2"}], ")"}]}], ",", 
            RowBox[{"cylr", "+", "del"}]}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"b1x", ",", "b1y", ",", "b1z"}], "}"}], "]"}], ";"}], 
      "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"b2", "[", 
      RowBox[{"x", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}], ".."}], "}"}]}], "]"}], ":=", 
     RowBox[{"b2", "/@", "x"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"b2", "[", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"b2x", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{"ii", ",", "x", ",", 
            RowBox[{"z", "-", "H", "-", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", "x", ",", 
            RowBox[{"y", "-", "cylr", "-", "del"}], ",", 
            RowBox[{"z", "-", 
             RowBox[{"(", 
              RowBox[{"H", "/", "2"}], ")"}]}], ",", "H"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", "x", ",", 
            RowBox[{"z", "+", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b2y", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{"ii", ",", "x", ",", 
            RowBox[{"z", "-", "H", "-", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", "x", ",", 
            RowBox[{"y", "-", "cylr", "-", "del"}], ",", 
            RowBox[{"z", "-", 
             RowBox[{"(", 
              RowBox[{"H", "/", "2"}], ")"}]}], ",", "H"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", "x", ",", 
            RowBox[{"z", "+", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b2z", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{"ii", ",", "x", ",", 
            RowBox[{"z", "-", "H", "-", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", "x", ",", 
            RowBox[{"y", "-", "cylr", "-", "del"}], ",", 
            RowBox[{"z", "-", 
             RowBox[{"(", 
              RowBox[{"H", "/", "2"}], ")"}]}], ",", "H"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", "x", ",", 
            RowBox[{"z", "+", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"b2x", ",", "b2y", ",", "b2z"}], "}"}], "]"}], ";"}], 
      "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"b22", "[", 
      RowBox[{"x", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}], ".."}], "}"}]}], "]"}], ":=", 
     RowBox[{"b22", "/@", "x"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         SqrtBox["3"], " ", "x"}], "2"], "-", 
       FractionBox["y", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]], "+", 
       FractionBox["z", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], ",", 
      RowBox[{
       FractionBox["x", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]], "+", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          SqrtBox["3"]}], ")"}], " ", "y"}], "+", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          SqrtBox["3"]}], ")"}], " ", "z"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["x", 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}], "+", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          SqrtBox["3"]}], ")"}], " ", "y"}], "+", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          SqrtBox["3"]}], ")"}], " ", "z"}]}]}], "}"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"b22", "[", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"b22x", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{"ii", ",", "x", ",", 
            RowBox[{"z", "-", "H", "-", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{
               SqrtBox["3"], " ", "x"}], "2"], "-", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"y", "-", "cylr", "-", "del"}], ")"}], 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]], "+", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"z", "-", 
                RowBox[{"(", 
                 FractionBox[
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["H", "2"], "*", "4", " ", 
                    SuperscriptBox["cylr", "2"]}]], "2"], ")"}]}], ")"}], 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]], "-", "del2"}], ",", 
            RowBox[{
             FractionBox["x", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]], "+", 
             RowBox[{
              FractionBox["1", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "+", 
                SqrtBox["3"]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"y", "-", "cylr", "-", "del"}], ")"}]}], "+", 
             RowBox[{
              FractionBox["1", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                SqrtBox["3"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"z", "-", 
                RowBox[{"(", 
                 FractionBox[
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["H", "2"], "*", "4", " ", 
                    SuperscriptBox["cylr", "2"]}]], "2"], ")"}]}], ")"}]}], 
             "-", "del2"}], ",", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["x", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], "+", 
             RowBox[{
              FractionBox["1", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                SqrtBox["3"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"y", "-", "cylr", "-", "del"}], ")"}]}], "+", 
             RowBox[{
              FractionBox["1", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "+", 
                SqrtBox["3"]}], ")"}], "  ", 
              RowBox[{"(", 
               RowBox[{"z", "-", 
                RowBox[{"(", 
                 FractionBox[
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["H", "2"], "*", "4", " ", 
                    SuperscriptBox["cylr", "2"]}]], "2"], ")"}]}], ")"}]}]}], 
            ",", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["H", "2"], "*", "4", " ", 
              SuperscriptBox["cylr", "2"]}]]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", 
            RowBox[{"y", "-", "cylr"}], ",", 
            RowBox[{"z", "+", "del"}], ",", 
            RowBox[{"x", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b22y", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{"ii", ",", "x", ",", 
            RowBox[{"z", "-", "H", "-", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{
               SqrtBox["3"], " ", "x"}], "2"], "-", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"y", "-", "cylr", "-", "del"}], ")"}], 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]], "+", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"z", "-", 
                RowBox[{"(", 
                 FractionBox[
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["H", "2"], "*", "4", " ", 
                    SuperscriptBox["cylr", "2"]}]], "2"], ")"}]}], ")"}], 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]], "-", "del2"}], ",", 
            RowBox[{
             FractionBox["x", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]], "+", 
             RowBox[{
              FractionBox["1", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "+", 
                SqrtBox["3"]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"y", "-", "cylr", "-", "del"}], ")"}]}], "+", 
             RowBox[{
              FractionBox["1", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                SqrtBox["3"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"z", "-", 
                RowBox[{"(", 
                 FractionBox[
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["H", "2"], "*", "4", " ", 
                    SuperscriptBox["cylr", "2"]}]], "2"], ")"}]}], ")"}]}], 
             "-", "del2"}], ",", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["x", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], "+", 
             RowBox[{
              FractionBox["1", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                SqrtBox["3"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"y", "-", "cylr", "-", "del"}], ")"}]}], "+", 
             RowBox[{
              FractionBox["1", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "+", 
                SqrtBox["3"]}], ")"}], "  ", 
              RowBox[{"(", 
               RowBox[{"z", "-", 
                RowBox[{"(", 
                 FractionBox[
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["H", "2"], "*", "4", " ", 
                    SuperscriptBox["cylr", "2"]}]], "2"], ")"}]}], ")"}]}]}], 
            ",", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["H", "2"], "*", "4", " ", 
              SuperscriptBox["cylr", "2"]}]]}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", 
            RowBox[{"y", "-", "cylr"}], ",", 
            RowBox[{"z", "+", "del"}], ",", 
            RowBox[{"x", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b22z", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{"ii", ",", "x", ",", 
            RowBox[{"z", "-", "H", "-", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{
               SqrtBox["3"], " ", "x"}], "2"], "-", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"y", "-", "cylr", "-", "del"}], ")"}], 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]], "+", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"z", "-", 
                RowBox[{"(", 
                 FractionBox[
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["H", "2"], "*", "4", " ", 
                    SuperscriptBox["cylr", "2"]}]], "2"], ")"}]}], ")"}], 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]], "-", "del2"}], ",", 
            RowBox[{
             FractionBox["x", 
              RowBox[{"2", " ", 
               SqrtBox["2"]}]], "+", 
             RowBox[{
              FractionBox["1", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "+", 
                SqrtBox["3"]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"y", "-", "cylr", "-", "del"}], ")"}]}], "+", 
             RowBox[{
              FractionBox["1", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                SqrtBox["3"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"z", "-", 
                RowBox[{"(", 
                 FractionBox[
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["H", "2"], "*", "4", " ", 
                    SuperscriptBox["cylr", "2"]}]], "2"], ")"}]}], ")"}]}], 
             "-", "del2"}], ",", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["x", 
               RowBox[{"2", " ", 
                SqrtBox["2"]}]]}], "+", 
             RowBox[{
              FractionBox["1", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                SqrtBox["3"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"y", "-", "cylr", "-", "del"}], ")"}]}], "+", 
             RowBox[{
              FractionBox["1", "4"], " ", 
              RowBox[{"(", 
               RowBox[{"2", "+", 
                SqrtBox["3"]}], ")"}], "  ", 
              RowBox[{"(", 
               RowBox[{"z", "-", 
                RowBox[{"(", 
                 FractionBox[
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["H", "2"], "*", "4", " ", 
                    SuperscriptBox["cylr", "2"]}]], "2"], ")"}]}], ")"}]}]}], 
            ",", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["H", "2"], "*", "4", " ", 
              SuperscriptBox["cylr", "2"]}]]}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{
            RowBox[{"-", "ii"}], ",", 
            RowBox[{"y", "-", "cylr"}], ",", 
            RowBox[{"z", "+", "del"}], ",", 
            RowBox[{"x", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"bl", "[", 
          RowBox[{
           RowBox[{"-", "ii"}], ",", 
           RowBox[{
            RowBox[{"x", "*", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"1", "/", "3"}], "]"}]}], "-", "del2"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"y", "-", "cylr", "-", "del"}], ")"}], "*", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"1", "/", "3"}], "]"}]}], "-", "del2"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"z", "-", 
              RowBox[{"(", 
               FractionBox[
                SqrtBox[
                 RowBox[{
                  SuperscriptBox["H", "2"], "*", "4", " ", 
                  SuperscriptBox["cylr", "2"]}]], "2"], ")"}]}], ")"}], 
            "\[Times]", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"1", "/", "3"}], "]"}]}], ",", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["H", "2"], "*", "4", " ", 
             SuperscriptBox["cylr", "2"]}]]}], "]"}], "+"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"b22x", ",", "b22y", ",", "b22z"}], "}"}], "]"}], ";"}], 
      "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"b3", "[", 
      RowBox[{"x", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}], ".."}], "}"}]}], "]"}], ":=", 
     RowBox[{"b3", "/@", "x"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"b3", "[", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"b3x", "=", 
        RowBox[{
         RowBox[{"bl", "[", 
          RowBox[{"ii", ",", "x", ",", 
           RowBox[{"z", "-", "H", "-", "del"}], ",", 
           RowBox[{"y", "-", "cylr"}], ",", 
           RowBox[{"2", "cylr"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b3y", "=", 
        RowBox[{
         RowBox[{"bl", "[", 
          RowBox[{"ii", ",", "x", ",", 
           RowBox[{"z", "-", "H", "-", "del"}], ",", 
           RowBox[{"y", "-", "cylr"}], ",", 
           RowBox[{"2", "cylr"}]}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b3z", "=", 
        RowBox[{
         RowBox[{"bl", "[", 
          RowBox[{"ii", ",", "x", ",", 
           RowBox[{"z", "-", "H", "-", "del"}], ",", 
           RowBox[{"y", "-", "cylr"}], ",", 
           RowBox[{"2", "cylr"}]}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"b3x", ",", "b3y", ",", "b3z"}], "}"}], "]"}], ";"}], 
      "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"b32", "[", 
      RowBox[{"x", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}], ".."}], "}"}]}], "]"}], ":=", 
     RowBox[{"b32", "/@", "x"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"b32", "[", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"b32x", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{"ii", ",", "x", ",", 
            RowBox[{"z", "-", "H", "-", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{"ii", ",", 
            RowBox[{"y", "-", "cylr"}], ",", 
            RowBox[{"z", "-", "H", "-", "del"}], ",", 
            RowBox[{"x", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b32y", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{"ii", ",", "x", ",", 
            RowBox[{"z", "-", "H", "-", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{"ii", ",", 
            RowBox[{"y", "-", "cylr"}], ",", 
            RowBox[{"z", "-", "H", "-", "del"}], ",", 
            RowBox[{"x", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b32z", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{"ii", ",", "x", ",", 
            RowBox[{"z", "-", "H", "-", "del"}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"bl", "[", 
           RowBox[{"ii", ",", 
            RowBox[{"y", "-", "cylr"}], ",", 
            RowBox[{"z", "-", "H", "-", "del"}], ",", 
            RowBox[{"x", "-", 
             RowBox[{"(", 
              RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"b32x", ",", "b32y", ",", "b32z"}], "}"}], "]"}], ";"}], 
      "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"btest", "[", 
      RowBox[{"x", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}], ".."}], "}"}]}], "]"}], ":=", 
     RowBox[{"btest", "/@", "x"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"btest", "[", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Return", "[", 
        RowBox[{"bc", "[", 
         RowBox[{"ii", ",", "x", ",", "y", ",", 
          RowBox[{"z", "-", 
           RowBox[{"(", 
            RowBox[{"H", "/", "2"}], ")"}]}], ",", 
          RowBox[{"cylr", "+", "del"}]}], "]"}], "]"}], ";"}], 
      "\[IndentingNewLine]", ")"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.696706167304099*^9, 3.6967062212789955`*^9}, {
   3.6967062855578775`*^9, 3.6967063170082035`*^9}, {3.696706367517437*^9, 
   3.696706376543376*^9}, 3.6967064305744143`*^9, {3.696706461588161*^9, 
   3.6967065510976195`*^9}, {3.6967065979202127`*^9, 
   3.6967066796461926`*^9}, {3.696706711778814*^9, 3.6967067143408732`*^9}, {
   3.6967068163595057`*^9, 3.696706847082343*^9}, {3.696706883432454*^9, 
   3.6967068854406576`*^9}, {3.6967070183627825`*^9, 
   3.6967070306772904`*^9}, {3.6967071121503963`*^9, 
   3.6967071563339415`*^9}, {3.6967071939816117`*^9, 
   3.6967072080091815`*^9}, {3.696707257979741*^9, 3.6967073992166553`*^9}, {
   3.6967075002139397`*^9, 3.696707519042575*^9}, {3.6967137808412232`*^9, 
   3.6967139704073176`*^9}, {3.69671403976783*^9, 3.696714047580353*^9}, {
   3.696714139423667*^9, 3.6967141833187027`*^9}, {3.6967147472752094`*^9, 
   3.6967147632647343`*^9}, {3.696714796674693*^9, 3.696714859095063*^9}, {
   3.6967150170499077`*^9, 3.696715017665121*^9}, {3.6967160896219273`*^9, 
   3.696716097353544*^9}, {3.6967167111721373`*^9, 3.6967168166824493`*^9}, 
   3.696716849648646*^9, 3.696717145798778*^9, {3.6967185125754185`*^9, 
   3.6967185252577972`*^9}, {3.69671857699829*^9, 3.696718588440241*^9}, 
   3.6967187143128424`*^9, 3.696718746055732*^9, 3.6967188845591745`*^9, {
   3.696718920596693*^9, 3.696718950676069*^9}, {3.6967189927137966`*^9, 
   3.6967189946259737`*^9}, {3.696719784411781*^9, 3.696719801548796*^9}, {
   3.696719840555005*^9, 3.6967198411110487`*^9}, {3.6967198886783037`*^9, 
   3.69671988949936*^9}, {3.696719934554954*^9, 3.696719949491435*^9}, {
   3.6967205991006904`*^9, 3.696720600278316*^9}, 3.6967210536978655`*^9, {
   3.6967212446197653`*^9, 3.6967212448439217`*^9}, 3.6967214799987993`*^9, 
   3.6967215845413556`*^9, 3.696721630204178*^9, {3.6967217136101966`*^9, 
   3.696721739666221*^9}, {3.696721771383394*^9, 3.6967217856619463`*^9}, {
   3.6967220687373533`*^9, 3.6967220734749117`*^9}, 3.696722143318177*^9, {
   3.6967223954794865`*^9, 3.6967224367428055`*^9}, {3.696722507338645*^9, 
   3.6967225138212833`*^9}, {3.6967225821584673`*^9, 
   3.6967225823508496`*^9}, {3.6967228138480844`*^9, 
   3.6967228238715925`*^9}, {3.6967558753093357`*^9, 3.696755884418991*^9}, {
   3.69788234687265*^9, 3.6978823476141787`*^9}, {3.6978990914646864`*^9, 
   3.6978991450801134`*^9}, {3.6978995119368553`*^9, 
   3.6978995220044107`*^9}, {3.6978995946504817`*^9, 
   3.6978996093604407`*^9}, {3.697899723635665*^9, 3.6978997275105867`*^9}, {
   3.697899902235351*^9, 3.697899930324988*^9}, {3.6979000206946917`*^9, 
   3.697900024016322*^9}, {3.6979009767765985`*^9, 3.6979009795065203`*^9}, {
   3.697901347084883*^9, 3.697901396703266*^9}, 3.697903707591835*^9, {
   3.6979037646569347`*^9, 3.6979037715908613`*^9}, {3.697903891771652*^9, 
   3.697903909052084*^9}, {3.697903948648226*^9, 3.697903948790525*^9}, {
   3.697904075404607*^9, 3.6979040756966033`*^9}, 3.6979041065479927`*^9, {
   3.697904273628513*^9, 3.697904307513502*^9}, {3.6979044267202864`*^9, 
   3.697904449559817*^9}, 3.697904820959364*^9, {3.697905027493903*^9, 
   3.697905052835494*^9}, {3.697905185491107*^9, 3.697905220977167*^9}, {
   3.69790551587863*^9, 3.6979055638240557`*^9}, {3.697906148414673*^9, 
   3.697906162769689*^9}, 3.697906615073878*^9, 3.6979099841394014`*^9, {
   3.6980627444583635`*^9, 3.6980628257296934`*^9}, {3.6980629072003784`*^9, 
   3.6980629191965637`*^9}, {3.698063265465457*^9, 3.698063266710952*^9}, {
   3.6980635031080923`*^9, 3.698063527552246*^9}, 3.698063583233246*^9, 
   3.6980637056925545`*^9, 3.6980638044893203`*^9, {3.698356643940752*^9, 
   3.698356686144998*^9}, {3.6983567353456416`*^9, 3.698356782990839*^9}, {
   3.6983568205916386`*^9, 3.6983568579825044`*^9}, {3.698356893535367*^9, 
   3.6983568980210485`*^9}, {3.6983569768882885`*^9, 3.698356982564171*^9}, {
   3.6983577059843583`*^9, 3.6983577532189054`*^9}, {3.6983578623787374`*^9, 
   3.6983578751603727`*^9}, {3.69835796168444*^9, 3.698358026556547*^9}, {
   3.6983580779740295`*^9, 3.6983581043715687`*^9}, {3.6983581479670095`*^9, 
   3.6983581495662875`*^9}, {3.6983584140238857`*^9, 3.69835853993241*^9}, {
   3.698358628062009*^9, 3.698358654566183*^9}, {3.698359357576583*^9, 
   3.6983593605321884`*^9}, {3.6983599517984085`*^9, 
   3.6983599944157863`*^9}, {3.6983600317752805`*^9, 
   3.6983600794456654`*^9}, {3.6983601163967776`*^9, 
   3.6983601844530015`*^9}, {3.698360257570162*^9, 3.6983602771659064`*^9}, 
   3.698360773394824*^9, {3.698362176607641*^9, 3.6983621776981535`*^9}, {
   3.6983634423128023`*^9, 3.698363520669056*^9}, {3.6983636965126953`*^9, 
   3.698363783720587*^9}, 3.698363840331712*^9, {3.698364219499729*^9, 
   3.6983646842755027`*^9}, {3.698364718000098*^9, 3.698364779706614*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fieldb1", "=", 
   RowBox[{"b1", "[", "latticepts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mean", "[", "fieldb1", "]"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]], 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "9"}]]}], "}"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<lattice_b1.dat\>\"", ",", "fieldb1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fieldb2", "=", 
   RowBox[{"b2", "[", "latticepts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mean", "[", "fieldb2", "]"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]], 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "9"}]]}], "}"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<lattice_b2.dat\>\"", ",", "fieldb2"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fieldb22", "=", 
   RowBox[{"b22", "[", "latticepts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mean", "[", "fieldb22", "]"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]], 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "9"}]]}], "}"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<lattice_b22.dat\>\"", ",", "fieldb22"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fieldb3", "=", 
   RowBox[{"b3", "[", "latticepts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mean", "[", "fieldb3", "]"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]], 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "9"}]]}], "}"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<lattice_b3.dat\>\"", ",", "fieldb3"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fieldb32", "=", 
   RowBox[{"b32", "[", "latticepts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mean", "[", "fieldb32", "]"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]], 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "9"}]]}], "}"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<lattice_b32.dat\>\"", ",", "fieldb32"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6983621882185073`*^9, 3.698362189134873*^9}, {
  3.69836226873732*^9, 3.6983623071147184`*^9}, {3.6983651330357957`*^9, 
  3.6983651419930463`*^9}, {3.698365179558193*^9, 3.6983652256241026`*^9}, {
  3.69836552723549*^9, 3.698365602230359*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.5682661626068874`", ",", 
   RowBox[{"-", "0.006671727783982848`"}], ",", "0.21652800780249823`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.69836576033665*^9}],

Cell[BoxData["\<\"lattice_b1.dat\"\>"], "Output",
 CellChangeTimes->{3.6983657710643187`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.597981487627865`", ",", "0.014423912179076893`", ",", 
   RowBox[{"-", "0.0005301645641605339`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6983658091727996`*^9}],

Cell[BoxData["\<\"lattice_b2.dat\"\>"], "Output",
 CellChangeTimes->{3.698365814449718*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.8008540068516457`", ",", "0.8721077909756427`", ",", 
   "0.01633337383234465`"}], "}"}]], "Output",
 CellChangeTimes->{3.6983658790095725`*^9}],

Cell[BoxData["\<\"lattice_b22.dat\"\>"], "Output",
 CellChangeTimes->{3.6983658841231627`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.6024259820208684`", ",", "0.`", ",", 
   RowBox[{"-", "0.00026347530930528033`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6983658989087043`*^9}],

Cell[BoxData["\<\"lattice_b3.dat\"\>"], "Output",
 CellChangeTimes->{3.6983659037817297`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.214544830692845`", ",", "0.8944785349189325`", ",", 
   RowBox[{"-", "0.016854722886320422`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6983659334899244`*^9}],

Cell[BoxData["\<\"lattice_b32.dat\"\>"], "Output",
 CellChangeTimes->{3.698365938898837*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test", "Chapter",
 CellChangeTimes->{{3.6961703297663755`*^9, 3.696170330077281*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fieldb1", "=", 
   RowBox[{"b1", "[", "latticepts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mean", "[", "fieldb1", "]"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]], 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "9"}]]}], "}"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.6983621882185073`*^9, 3.698362189134873*^9}, {
  3.69836226873732*^9, 3.6983623071147184`*^9}, {3.6983651330357957`*^9, 
  3.6983651419930463`*^9}, {3.698365179558193*^9, 3.6983652256241026`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.5682661626068874`", ",", 
   RowBox[{"-", "0.006671727783982848`"}], ",", "0.21652800780249823`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.698365368755315*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fieldb2", "=", 
   RowBox[{"b2", "[", "latticepts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mean", "[", "fieldb2", "]"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]], 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "9"}]]}], "}"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.698365143560068*^9, 3.69836514390913*^9}, {
  3.6983651812339897`*^9, 3.6983651816030245`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.597981487627865`", ",", "0.014423912179076893`", ",", 
   RowBox[{"-", "0.0005301645641605339`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6983654096492043`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fieldb22", "=", 
   RowBox[{"b22", "[", "latticepts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mean", "[", "fieldb22", "]"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]], 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "9"}]]}], "}"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.6983651907491455`*^9, 3.698365191121915*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.8008540068516457`", ",", "0.8721077909756427`", ",", 
   "0.01633337383234465`"}], "}"}]], "Output",
 CellChangeTimes->{3.698365475583434*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fieldb3", "=", 
   RowBox[{"b3", "[", "latticepts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mean", "[", "fieldb3", "]"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]], 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "9"}]]}], "}"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.6983652051372833`*^9, 3.6983652054697504`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.6024259820208684`", ",", "0.`", ",", 
   RowBox[{"-", "0.00026347530930528033`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6983654898951907`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fieldb32", "=", 
   RowBox[{"b32", "[", "latticepts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mean", "[", "fieldb32", "]"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]], 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "9"}]]}], "}"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.698365219423199*^9, 3.6983652205891585`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fieldb22", "=", 
   RowBox[{"b22", "[", "latticepts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mean", "[", "fieldb22", "]"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]], 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "9"}]]}], "}"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.6983623198989544`*^9, 3.69836232023885*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.6974853574238327`", ",", "1.6088138236379068`", ",", "0.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.698362362739607*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"b32", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bx", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"bl", "[", 
         RowBox[{"ii", ",", "x", ",", 
          RowBox[{"z", "-", "H", "-", "del"}], ",", 
          RowBox[{"y", "-", 
           RowBox[{"(", 
            RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "+", 
       RowBox[{
        RowBox[{"bl", "[", 
         RowBox[{"ii", ",", 
          RowBox[{"y", "-", "cylr"}], ",", 
          RowBox[{"z", "-", "H", "-", "del"}], ",", 
          RowBox[{"x", "-", 
           RowBox[{"(", 
            RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"by", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"bl", "[", 
         RowBox[{"ii", ",", "x", ",", 
          RowBox[{"z", "-", "H", "-", "del"}], ",", 
          RowBox[{"y", "-", 
           RowBox[{"(", 
            RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "+", 
       RowBox[{
        RowBox[{"bl", "[", 
         RowBox[{"ii", ",", 
          RowBox[{"y", "-", "cylr"}], ",", 
          RowBox[{"z", "-", "H", "-", "del"}], ",", 
          RowBox[{"x", "-", 
           RowBox[{"(", 
            RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bz", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"bl", "[", 
         RowBox[{"ii", ",", "x", ",", 
          RowBox[{"z", "-", "H", "-", "del"}], ",", 
          RowBox[{"y", "-", 
           RowBox[{"(", 
            RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", 
       RowBox[{
        RowBox[{"bl", "[", 
         RowBox[{"ii", ",", 
          RowBox[{"y", "-", "cylr"}], ",", 
          RowBox[{"z", "-", "H", "-", "del"}], ",", 
          RowBox[{"x", "-", 
           RowBox[{"(", 
            RowBox[{"cylr", "/", "2"}], ")"}]}], ",", "cylr"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"bx", ",", "by", ",", "bz"}], "}"}], "]"}], ";"}], 
    "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fieldb32", "=", 
   RowBox[{"b32", "[", "latticepts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mean", "[", "fieldb32", "]"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]], 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "9"}]]}], "}"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.6983623344329414`*^9, 3.6983623347801332`*^9}, {
   3.6983628609059424`*^9, 3.6983628843414683`*^9}, {3.6983629247705297`*^9, 
   3.698362985406973*^9}, {3.6983630284175167`*^9, 3.6983630288574033`*^9}, {
   3.6983631035317235`*^9, 3.698363108677825*^9}, 3.6983635317932243`*^9, {
   3.698363584076168*^9, 3.698363641491707*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.214544830692845`", ",", "0.8944785349189325`", ",", 
   RowBox[{"-", "0.016854722886320422`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6983632316234674`*^9, 3.6983635644108243`*^9, 
  3.698363680129487*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fieldb3", "=", 
   RowBox[{"b3", "[", "latticepts", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mean", "[", "fieldb3", "]"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]], 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "11"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "9"}]]}], "}"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.6983638020203166`*^9, 3.6983638097511854`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.6024259820208684`", ",", "0.`", ",", 
   RowBox[{"-", "0.00026347530930528033`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6983638109896092`*^9, 3.6983638282296576`*^9}, 
   3.698363866565524*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fieldb32", "[", 
  RowBox[{"[", "4000", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6983631517462053`*^9, 3.698363181278778*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "6.8849760558678705`*^-18", ",", "3.675817380161231`*^-19", ",", "0.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.698362378955057*^9, 3.6983628790965166`*^9, 3.6983629391000843`*^9, {
   3.6983631485877595`*^9, 3.698363182013669*^9}, 3.698363235356284*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"a", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k", ",", 
      RowBox[{"2", "k"}], ",", 
      RowBox[{"3", "k"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "10"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"b", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"10", "k"}], ",", 
       RowBox[{"20", "k"}], ",", 
       RowBox[{"30", "k"}]}], "}"}], "+", "1"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "10"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Flatten", ",", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<test.dat\>\"", ",", 
   RowBox[{"Map", "[", 
    RowBox[{"Flatten", ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6961678194693336`*^9, 3.6961679073783007`*^9}, 
   3.696169361618972*^9, {3.696169454602796*^9, 3.6961694844025164`*^9}, {
   3.6961696152167597`*^9, 3.6961696742143483`*^9}, {3.6961697495422053`*^9, 
   3.696169769249509*^9}, {3.6961698684127316`*^9, 3.6961698751283903`*^9}, {
   3.696169906145523*^9, 3.696169906399864*^9}, {3.696169954256898*^9, 
   3.6961700204887314`*^9}, {3.696170076752142*^9, 3.6961701031102777`*^9}, {
   3.696170192543788*^9, 3.696170195132925*^9}, {3.6961702285562*^9, 
   3.69617023661064*^9}, {3.696170347782277*^9, 3.696170353164749*^9}, {
   3.696170418009821*^9, 3.6961704250361147`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "8", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "10", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "12", ",", "18"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "14", ",", "21"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "16", ",", "24"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "18", ",", "27"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "20", ",", "30"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.696167881527851*^9, 3.6961678981130085`*^9}, 
   3.6961693652942076`*^9, {3.6961694572002335`*^9, 3.6961694849272137`*^9}, {
   3.696169625606531*^9, 3.6961696688116655`*^9}, 3.6961697708513203`*^9, 
   3.696169875606109*^9, 3.6961699070259647`*^9, {3.6961699648720818`*^9, 
   3.6961699923803043`*^9}, 3.69617002252169*^9, 3.696170103939288*^9, 
   3.696170133983783*^9, {3.6961701958099337`*^9, 3.696170238139599*^9}, 
   3.696170354354391*^9, 3.696170427626713*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"11", ",", "21", ",", "31"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"21", ",", "41", ",", "61"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"31", ",", "61", ",", "91"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"41", ",", "81", ",", "121"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"51", ",", "101", ",", "151"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"61", ",", "121", ",", "181"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"71", ",", "141", ",", "211"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"81", ",", "161", ",", "241"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"91", ",", "181", ",", "271"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"101", ",", "201", ",", "301"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.696167881527851*^9, 3.6961678981130085`*^9}, 
   3.6961693652942076`*^9, {3.6961694572002335`*^9, 3.6961694849272137`*^9}, {
   3.696169625606531*^9, 3.6961696688116655`*^9}, 3.6961697708513203`*^9, 
   3.696169875606109*^9, 3.6961699070259647`*^9, {3.6961699648720818`*^9, 
   3.6961699923803043`*^9}, 3.69617002252169*^9, 3.696170103939288*^9, 
   3.696170133983783*^9, {3.6961701958099337`*^9, 3.696170238139599*^9}, 
   3.696170354354391*^9, 3.696170427635691*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "11", ",", "21", ",", "31"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "6", ",", "21", ",", "41", ",", "61"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6", ",", "9", ",", "31", ",", "61", ",", "91"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "8", ",", "12", ",", "41", ",", "81", ",", "121"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "10", ",", "15", ",", "51", ",", "101", ",", "151"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "12", ",", "18", ",", "61", ",", "121", ",", "181"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "14", ",", "21", ",", "71", ",", "141", ",", "211"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "16", ",", "24", ",", "81", ",", "161", ",", "241"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "18", ",", "27", ",", "91", ",", "181", ",", "271"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "20", ",", "30", ",", "101", ",", "201", ",", "301"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.696167881527851*^9, 3.6961678981130085`*^9}, 
   3.6961693652942076`*^9, {3.6961694572002335`*^9, 3.6961694849272137`*^9}, {
   3.696169625606531*^9, 3.6961696688116655`*^9}, 3.6961697708513203`*^9, 
   3.696169875606109*^9, 3.6961699070259647`*^9, {3.6961699648720818`*^9, 
   3.6961699923803043`*^9}, 3.69617002252169*^9, 3.696170103939288*^9, 
   3.696170133983783*^9, {3.6961701958099337`*^9, 3.696170238139599*^9}, 
   3.696170354354391*^9, 3.696170427644704*^9}],

Cell[BoxData["\<\"test.dat\"\>"], "Output",
 CellChangeTimes->{{3.696167881527851*^9, 3.6961678981130085`*^9}, 
   3.6961693652942076`*^9, {3.6961694572002335`*^9, 3.6961694849272137`*^9}, {
   3.696169625606531*^9, 3.6961696688116655`*^9}, 3.6961697708513203`*^9, 
   3.696169875606109*^9, 3.6961699070259647`*^9, {3.6961699648720818`*^9, 
   3.6961699923803043`*^9}, 3.69617002252169*^9, 3.696170103939288*^9, 
   3.696170133983783*^9, {3.6961701958099337`*^9, 3.696170238139599*^9}, 
   3.696170354354391*^9, 3.696170427652203*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rrr", "=", 
  RowBox[{"RotationTransform", "[", 
   RowBox[{
    RowBox[{"Pi", "/", "6"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"rrr", "[", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.698359880201783*^9, 3.698359907982098*^9}, {
  3.6983622310277925`*^9, 3.6983622345976024`*^9}}],

Cell[BoxData[
 RowBox[{"TransformationFunction", "[", 
  RowBox[{"(", 
   TagBox[GridBox[{
      {
       FractionBox[
        SqrtBox["3"], "2"], 
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}], 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]], "0"},
      {
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]], 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          SqrtBox["3"]}], ")"}]}], 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          SqrtBox["3"]}], ")"}]}], "0"},
      {
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"2", " ", 
          SqrtBox["2"]}]]}], 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          SqrtBox["3"]}], ")"}]}], 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          SqrtBox["3"]}], ")"}]}], "0"},
      {"0", "0", "0", "1"}
     },
     AutoDelete->False,
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {-2 -> True}, 
       "Rows" -> {{False}}, "RowsIndexed" -> {-2 -> True}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    #& ], ")"}], "]"}]], "Output",
 CellChangeTimes->{3.6983599088491883`*^9, 3.698362235910901*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      SqrtBox["3"], " ", "x"}], "2"], "-", 
    FractionBox["y", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]], "+", 
    FractionBox["z", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}], ",", 
   RowBox[{
    FractionBox["x", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]], "+", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       SqrtBox["3"]}], ")"}], " ", "y"}], "+", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"2", "-", 
       SqrtBox["3"]}], ")"}], " ", "z"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["x", 
      RowBox[{"2", " ", 
       SqrtBox["2"]}]]}], "+", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"2", "-", 
       SqrtBox["3"]}], ")"}], " ", "y"}], "+", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       SqrtBox["3"]}], ")"}], " ", "z"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6983599088491883`*^9, 3.6983622359611406`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1600, 817},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.2 Inherited,
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 156, 2, 88, "Chapter"],
Cell[CellGroupData[{
Cell[761, 28, 3134, 77, 408, "Input"],
Cell[CellGroupData[{
Cell[3920, 109, 642, 14, 26, "Print"],
Cell[4565, 125, 614, 12, 26, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5240, 144, 158, 2, 88, "Chapter"],
Cell[CellGroupData[{
Cell[5423, 150, 9016, 207, 694, "Input"],
Cell[CellGroupData[{
Cell[14464, 361, 1057, 18, 26, "Print"],
Cell[15524, 381, 1546, 26, 26, "Print"],
Cell[17073, 409, 1039, 17, 26, "Print"],
Cell[18115, 428, 1618, 27, 26, "Print"],
Cell[19736, 457, 1048, 18, 26, "Print"],
Cell[20787, 477, 1560, 26, 26, "Print"],
Cell[22350, 505, 1588, 30, 26, "Print"]
}, Open  ]],
Cell[23953, 538, 400, 5, 36, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24402, 549, 152, 2, 88, "Chapter"],
Cell[24557, 553, 15056, 374, 873, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39650, 932, 150, 2, 88, "Chapter"],
Cell[39803, 936, 34280, 865, 1889, "Input"],
Cell[CellGroupData[{
Cell[74108, 1805, 3385, 103, 369, "Input"],
Cell[77496, 1910, 203, 5, 36, "Output"],
Cell[77702, 1917, 93, 1, 36, "Output"],
Cell[77798, 1920, 204, 4, 36, "Output"],
Cell[78005, 1926, 91, 1, 36, "Output"],
Cell[78099, 1929, 189, 5, 36, "Output"],
Cell[78291, 1936, 94, 1, 36, "Output"],
Cell[78388, 1939, 188, 4, 36, "Output"],
Cell[78579, 1945, 93, 1, 36, "Output"],
Cell[78675, 1948, 201, 4, 36, "Output"],
Cell[78879, 1954, 92, 1, 93, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[79020, 1961, 91, 1, 88, "Chapter"],
Cell[CellGroupData[{
Cell[79136, 1966, 729, 20, 62, "Input"],
Cell[79868, 1988, 204, 5, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80109, 1998, 628, 19, 62, "Input"],
Cell[80740, 2019, 204, 4, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80981, 2028, 581, 18, 62, "Input"],
Cell[81565, 2048, 187, 5, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81789, 2058, 580, 18, 62, "Input"],
Cell[82372, 2078, 188, 4, 36, "Output"]
}, Open  ]],
Cell[82575, 2085, 581, 18, 62, "Input"],
Cell[CellGroupData[{
Cell[83181, 2107, 580, 18, 62, "Input"],
Cell[83764, 2127, 166, 4, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83967, 2136, 3409, 90, 200, "Input"],
Cell[87379, 2228, 250, 5, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87666, 2238, 580, 18, 62, "Input"],
Cell[88249, 2258, 240, 5, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88526, 2268, 155, 3, 36, "Input"],
Cell[88684, 2273, 303, 7, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89024, 2285, 1789, 47, 106, "Input"],
Cell[90816, 2334, 1248, 29, 36, "Output"],
Cell[92067, 2365, 1278, 29, 36, "Output"],
Cell[93348, 2396, 1639, 39, 60, "Output"],
Cell[94990, 2437, 534, 7, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95561, 2449, 445, 12, 60, "Input"],
Cell[96009, 2463, 1489, 51, 136, "Output"],
Cell[97501, 2516, 1117, 42, 65, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)


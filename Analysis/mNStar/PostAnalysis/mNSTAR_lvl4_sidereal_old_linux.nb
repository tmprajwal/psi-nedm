(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     73995,       1876]
NotebookOptionsPosition[     71477,       1830]
NotebookOutlinePosition[     71825,       1845]
CellTagsIndexPosition[     71782,       1842]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OS", "=", "\"\<win\>\""}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"or", ",", "linux"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<EDA`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<CustomTicks`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"LinTicks", ",", 
    RowBox[{"TickLabelStep", "\[Rule]", "1"}], ",", 
    RowBox[{"MajorTickLength", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.0125", ",", "0"}], "}"}]}], ",", 
    RowBox[{"MinorTickLength", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.0075", ",", "0"}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"OS", "\[Equal]", "\"\<win\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Working Directory: \>\"", ",", 
       RowBox[{
       "descDir", "=", 
        "\"\<C:\\\\Users\\\\tmpra\\\\Dropbox\\\\nEDM\\\\analysis-mirror_\
neutrons\\\\nstar_online\>\""}]}], "]"}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<(AscDir) Rawdata Directory: \>\"", ",", 
       RowBox[{
       "AscDir", "=", 
        "\"\<C:\\\\Users\\\\tmpra\\\\Dropbox\\\\nEDM\\\\rawdata\>\""}]}], 
      "]"}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<(ScrDir) Scratch Directory: \>\"", ",", 
       RowBox[{"curDir", "=", 
        RowBox[{
        "SetDirectory", "[", 
         "\"\<C:\\\\Users\\\\tmpra\\\\Dropbox\\\\Scratch\>\"", "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<(PicDir) Picture Directory: \>\"", ",", 
       RowBox[{
       "PicDir", "=", 
        "\"\<C:\\\\Users\\\\tmpra\\\\Dropbox\\\\nEDM\\\\Pictures\\\\nstar\\\\\
runs2\>\""}]}], "]"}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<(SysDir) System Directory: \>\"", ",", 
       RowBox[{
       "SysDir", "=", 
        "\"\<C:\\\\Users\\\\tmpra\\\\Dropbox\\\\nEDM\\\\system\>\""}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Rawdata on mpc1636:\>\"", ",", 
       RowBox[{"mpcDir", "=", "\"\</xdata/nedm_data/RawData\>\""}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"seperator", "=", "\"\<\\\\\>\""}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"OS", "\[Equal]", "\"\<axion\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Working Directory: \>\"", ",", 
       RowBox[{
       "descDir", "=", 
        "\"\</home/prajwal/Dropbox/nEDM/analysis-mirror_neutrons/nstar_online\
\>\""}]}], "]"}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<(AscDir) Rawdata Directory: \>\"", ",", 
       RowBox[{
       "AscDir", "=", "\"\</home/prajwal/Dropbox/nEDM/rawdata\>\""}]}], "]"}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<(ScrDir) Scratch Directory: \>\"", ",", 
       RowBox[{"curDir", "=", 
        RowBox[{
        "SetDirectory", "[", "\"\</home/prajwal/Dropbox/Scratch\>\"", 
         "]"}]}]}], "]"}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<(PicDir) Picture Directory: \>\"", ",", 
       RowBox[{
       "PicDir", "=", 
        "\"\</home/prajwal/Dropbox/nEDM/Pictures/nstar/runs\>\""}]}], "]"}], 
     ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<(SysDir) System Directory: \>\"", ",", 
       RowBox[{"SysDir", "=", "\"\</home/prajwal/Dropbox/nEDM/system\>\""}]}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Rawdata on mpc1636:\>\"", ",", 
       RowBox[{"mpcDir", "=", "\"\</xdata/nedm_data/RawData\>\""}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"seperator", "=", "\"\</\>\""}], ";"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metaStructure", "=", 
   RowBox[{"{", 
    RowBox[{
    "Word", ",", "Real", ",", "Real", ",", "Word", ",", "Real", ",", "Real", 
     ",", "Word", ",", "Real", ",", "Real", ",", "Real", ",", "Real", ",", 
     "Real", ",", "Real", ",", "Real", ",", "Real", ",", "Real", ",", "Real", 
     ",", "Real", ",", "Real", ",", "Real", ",", "Real", ",", "Real", ",", 
     "Real", ",", "Word", ",", "Real", ",", "Real", ",", "Real", ",", "Real", 
     ",", "Real", ",", "Real", ",", "Real", ",", "Real", ",", "Real", ",", 
     "Real", ",", "Real", ",", "Real", ",", "Word", ",", "Real", ",", "Real", 
     ",", "Real", ",", "Real", ",", "Real", ",", "Real", ",", "Real", ",", 
     "Real", ",", "Real", ",", "Real", ",", "Real", ",", "Real", ",", "Real", 
     ",", "Real", ",", "Real", ",", "Real", ",", "Word", ",", "Real", ",", 
     "Real", ",", "Real", ",", "Real", ",", "Real", ",", "Real", ",", "Real", 
     ",", "Real", ",", "Real", ",", "Real", ",", "Real"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metadesc", "=", 
   RowBox[{"{", 
    RowBox[{
    "Number", ",", "Number", ",", "Number", ",", "Number", ",", "Number", ",",
      "Number", ",", "Number", ",", "Word", ",", "Real", ",", "Real", ",", 
     "Real", ",", "Real"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"descdat", "=", 
   RowBox[{"ReadList", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"descDir", ",", "seperator", ",", "\"\<desctf_c.dat\>\""}], 
      "]"}], ",", "metadesc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dimdesc", "=", 
    RowBox[{
     RowBox[{"Dimensions", "[", "descdat", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"LS", "-", "Periodogram"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LS", "[", 
    RowBox[{"tx_", ",", " ", "nP_"}], "]"}], " ", ":=", " ", "\n", " ", 
   RowBox[{
    RowBox[{"LS", "[", 
     RowBox[{"tx", ",", " ", "nP"}], "]"}], " ", "=", " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t", ",", " ", "x", ",", " ", "xbar", ",", " ", "std", ",", " ", 
        "\[Tau]", ",", " ", "P", ",", " ", "\[CapitalOmega]", ",", " ", 
        "diff", ",", " ", "lim", ",", " ", "\n", "     ", "periodogram"}], 
       "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"t", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"tx", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "tx", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
        "    ", 
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"tx", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "tx", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
        "    ", 
       RowBox[{"xbar", " ", "=", " ", 
        RowBox[{"Mean", "[", "x", "]"}]}], ";", "\n", "    ", 
       RowBox[{"std", " ", "=", " ", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "x", "]"}], " ", "-", " ", "1."}], ")"}]}],
          " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "-", " ", "xbar"}], ")"}],
             "^", "2"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}]}], ";", 
       "\n", "    ", 
       RowBox[{
        RowBox[{"\[Tau]", "[", "\[Omega]_", "]"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{"\[Tau]", "[", "\[Omega]", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"ArcTan", "[", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"i", "=", "1"}], 
             RowBox[{"Length", "[", "tx", "]"}]], 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"2.", " ", "\[Omega]", " ", 
               RowBox[{"x", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"i", "=", "1"}], 
               RowBox[{"Length", "[", "tx", "]"}]], 
              RowBox[{"Cos", "[", 
               RowBox[{"2.", " ", "\[Omega]", " ", 
                RowBox[{"x", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}]}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"2.", " ", "\[Omega]"}], ")"}]}]}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"P", "[", "\[Omega]_", "]"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{"P", "[", "\[Omega]", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0.5", "/", "std"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"i", "=", "1"}], 
                 RowBox[{"Length", "[", "tx", "]"}]], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", "xbar"}], ")"}], " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                    RowBox[{"\[Tau]", "[", "\[Omega]", "]"}]}], ")"}]}], 
                  "]"}]}]}], ")"}], "^", "2"}], "/", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"i", "=", "1"}], 
               RowBox[{"Length", "[", "tx", "]"}]], 
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"t", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                   RowBox[{"\[Tau]", "[", "\[Omega]", "]"}]}], ")"}]}], "]"}],
                "2"]}]}], " ", "+", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"i", "=", "1"}], 
                 RowBox[{"Length", "[", "tx", "]"}]], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", "xbar"}], ")"}], " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                    RowBox[{"\[Tau]", "[", "\[Omega]", "]"}]}], ")"}]}], 
                  "]"}]}]}], ")"}], "^", "2"}], "/", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"i", "=", "1"}], 
               RowBox[{"Length", "[", "tx", "]"}]], 
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"t", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                   RowBox[{"\[Tau]", "[", "\[Omega]", "]"}]}], ")"}]}], "]"}],
                "2"]}]}]}], ")"}]}]}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "T_", "]"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{"\[CapitalOmega]", "[", "T", "]"}], " ", "=", " ", 
         RowBox[{"2.", " ", 
          RowBox[{"\[Pi]", "/", "T"}]}]}]}], ";", "\n", "    ", 
       RowBox[{"diff", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"t", "[", 
            RowBox[{"[", 
             RowBox[{"i", " ", "+", " ", "1"}], "]"}], "]"}], " ", "-", " ", 
           RowBox[{"t", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{
             RowBox[{"Length", "[", "t", "]"}], " ", "-", " ", "1"}]}], 
           "}"}]}], "]"}]}], ";", " ", "\n", "    ", 
       RowBox[{"lim", " ", "=", " ", 
        RowBox[{"\[CapitalOmega]", " ", "/@", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Last", "[", "t", "]"}], " ", "-", " ", 
            RowBox[{"First", "[", "t", "]"}]}], ",", " ", 
           RowBox[{"2", " ", 
            RowBox[{"Min", "[", "diff", "]"}]}]}], "}"}]}]}], ";", "\n", 
       "    ", 
       RowBox[{"periodogram", " ", "=", " ", "\n", "     ", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Omega]", ",", " ", 
            RowBox[{"P", "[", "\[Omega]", "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\[Omega]", ",", " ", 
            RowBox[{"lim", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\n", "       ", 
            RowBox[{"lim", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"lim", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
               RowBox[{"lim", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "nP"}]}], 
           "}"}]}], "]"}]}]}]}], "\n", "    ", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LSCos", "[", 
    RowBox[{"tx_", ",", " ", "nP_"}], "]"}], " ", ":=", " ", "\n", " ", 
   RowBox[{
    RowBox[{"LSCos", "[", 
     RowBox[{"tx", ",", " ", "nP"}], "]"}], " ", "=", " ", "\n", "  ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t", ",", " ", "x", ",", " ", "xbar", ",", " ", "std", ",", " ", 
        "\[Tau]", ",", " ", "P", ",", " ", "\[CapitalOmega]", ",", " ", 
        "diff", ",", " ", "lim", ",", " ", "\n", "     ", "periodogram"}], 
       "}"}], ",", "\n", "    ", 
      RowBox[{
       RowBox[{"t", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"tx", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "tx", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
        "    ", 
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"tx", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "tx", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
        "    ", 
       RowBox[{"xbar", " ", "=", " ", 
        RowBox[{"Mean", "[", "x", "]"}]}], ";", "\n", "    ", 
       RowBox[{"std", " ", "=", " ", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "x", "]"}], " ", "-", " ", "1."}], ")"}]}],
          " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "-", " ", "xbar"}], ")"}],
             "^", "2"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}]}], ";", 
       "\n", "    ", 
       RowBox[{
        RowBox[{"\[Tau]", "[", "\[Omega]_", "]"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{"\[Tau]", "[", "\[Omega]", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"ArcTan", "[", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"i", "=", "1"}], 
             RowBox[{"Length", "[", "tx", "]"}]], 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"2.", " ", "\[Omega]", " ", 
               RowBox[{"x", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"i", "=", "1"}], 
               RowBox[{"Length", "[", "tx", "]"}]], 
              RowBox[{"Sin", "[", 
               RowBox[{"2.", " ", "\[Omega]", " ", 
                RowBox[{"x", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}]}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"2.", " ", "\[Omega]"}], ")"}]}]}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"P", "[", "\[Omega]_", "]"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{"P", "[", "\[Omega]", "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0.5", "/", "std"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"i", "=", "1"}], 
                 RowBox[{"Length", "[", "tx", "]"}]], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", "xbar"}], ")"}], " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                    RowBox[{"\[Tau]", "[", "\[Omega]", "]"}]}], ")"}]}], 
                  "]"}]}]}], ")"}], "^", "2"}], "/", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"i", "=", "1"}], 
               RowBox[{"Length", "[", "tx", "]"}]], 
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"t", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                   RowBox[{"\[Tau]", "[", "\[Omega]", "]"}]}], ")"}]}], "]"}],
                "2"]}]}], " ", "+", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"i", "=", "1"}], 
                 RowBox[{"Length", "[", "tx", "]"}]], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", "xbar"}], ")"}], " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                    RowBox[{"\[Tau]", "[", "\[Omega]", "]"}]}], ")"}]}], 
                  "]"}]}]}], ")"}], "^", "2"}], "/", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"i", "=", "1"}], 
               RowBox[{"Length", "[", "tx", "]"}]], 
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"t", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                   RowBox[{"\[Tau]", "[", "\[Omega]", "]"}]}], ")"}]}], "]"}],
                "2"]}]}]}], ")"}]}]}]}], ";", "\n", "    ", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "T_", "]"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{"\[CapitalOmega]", "[", "T", "]"}], " ", "=", " ", 
         RowBox[{"2.", " ", 
          RowBox[{"\[Pi]", "/", "T"}]}]}]}], ";", "\n", "    ", 
       RowBox[{"diff", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"t", "[", 
            RowBox[{"[", 
             RowBox[{"i", " ", "+", " ", "1"}], "]"}], "]"}], " ", "-", " ", 
           RowBox[{"t", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{
             RowBox[{"Length", "[", "t", "]"}], " ", "-", " ", "1"}]}], 
           "}"}]}], "]"}]}], ";", " ", "\n", "    ", 
       RowBox[{"lim", " ", "=", " ", 
        RowBox[{"\[CapitalOmega]", " ", "/@", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Last", "[", "t", "]"}], " ", "-", " ", 
            RowBox[{"First", "[", "t", "]"}]}], ",", " ", 
           RowBox[{"2", " ", 
            RowBox[{"Min", "[", "diff", "]"}]}]}], "}"}]}]}], ";", "\n", 
       "    ", 
       RowBox[{"periodogram", " ", "=", " ", "\n", "     ", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Omega]", ",", " ", 
            RowBox[{"P", "[", "\[Omega]", "]"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\[Omega]", ",", " ", 
            RowBox[{"lim", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\n", "       ", 
            RowBox[{"lim", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"lim", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
               RowBox[{"lim", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "nP"}]}], 
           "}"}]}], "]"}]}]}]}], "\n", "    ", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{"periodogram_", ",", "rankmax_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"periodogram", ",", "rankmax"}], "]"}], "=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"power", ",", "\[Omega]max", ",", "period"}], "}"}], ",", 
      RowBox[{
       RowBox[{"power", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"periodogram", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "periodogram", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"\[Omega]max", "=", 
        RowBox[{"periodogram", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"power", ",", 
              RowBox[{"RankedMax", "[", 
               RowBox[{"power", ",", "rankmax"}], "]"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"period", "=", 
          RowBox[{"2", " ", 
           RowBox[{"\[Pi]", "/", "\[Omega]max"}]}]}], ",", 
         RowBox[{"RankedMax", "[", 
          RowBox[{"power", ",", "rankmax"}], "]"}]}], "}"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", 
    RowBox[{"z_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"z", ",", "n"}], "]"}], "=", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", "z"}], "]"}]}], ")"}], "^", "n"}]}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.721642240480857*^9, 3.721642269569461*^9}, {
  3.7256275613930483`*^9, 3.72562756141156*^9}, {3.725627631013009*^9, 
  3.7256276770998015`*^9}, {3.7256289101492257`*^9, 3.725628932025835*^9}, {
  3.7256289787640123`*^9, 3.725628992739915*^9}, {3.7286670720495424`*^9, 
  3.7286670969262114`*^9}, {3.729332991216321*^9, 3.7293330016468625`*^9}, {
  3.7293337336033125`*^9, 3.729333756579461*^9}, {3.729439836773017*^9, 
  3.729439852971504*^9}, {3.735476505316223*^9, 
  3.7354765053232307`*^9}},ExpressionUUID->"dea71d71-bbcb-4ca1-8a1a-\
83833dbb0201"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Working Directory: \"\>", 
   "\[InvisibleSpace]", \
"\<\"C:\\\\Users\\\\tmpra\\\\Dropbox\\\\nEDM\\\\analysis-mirror_neutrons\\\\\
nstar_online\"\>"}],
  SequenceForm[
  "Working Directory: ", 
   "C:\\Users\\tmpra\\Dropbox\\nEDM\\analysis-mirror_neutrons\\nstar_online"],
  Editable->False]], "Print",
 CellChangeTimes->{3.736771129913784*^9, 3.736771233426057*^9, 
  3.7368025176194963`*^9},ExpressionUUID->"1fc9330f-9a02-4b95-9c7e-\
0dc5556c1926"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"(AscDir) Rawdata Directory: \"\>", 
   "\[InvisibleSpace]", \
"\<\"C:\\\\Users\\\\tmpra\\\\Dropbox\\\\nEDM\\\\rawdata\"\>"}],
  SequenceForm[
  "(AscDir) Rawdata Directory: ", "C:\\Users\\tmpra\\Dropbox\\nEDM\\rawdata"],
  Editable->False]], "Print",
 CellChangeTimes->{3.736771129913784*^9, 3.736771233426057*^9, 
  3.7368025176254907`*^9},ExpressionUUID->"c35cb713-cbe4-437d-851c-\
90d207c657a2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"(ScrDir) Scratch Directory: \"\>", 
   "\[InvisibleSpace]", "\<\"C:\\\\Users\\\\tmpra\\\\Dropbox\\\\Scratch\"\>"}],
  SequenceForm[
  "(ScrDir) Scratch Directory: ", "C:\\Users\\tmpra\\Dropbox\\Scratch"],
  Editable->False]], "Print",
 CellChangeTimes->{3.736771129913784*^9, 3.736771233426057*^9, 
  3.736802517631488*^9},ExpressionUUID->"980cc5c7-6a1a-4251-b1b7-\
1f799ed1259c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"(PicDir) Picture Directory: \"\>", 
   "\[InvisibleSpace]", \
"\<\"C:\\\\Users\\\\tmpra\\\\Dropbox\\\\nEDM\\\\Pictures\\\\nstar\\\\runs2\"\>\
"}],
  SequenceForm[
  "(PicDir) Picture Directory: ", 
   "C:\\Users\\tmpra\\Dropbox\\nEDM\\Pictures\\nstar\\runs2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.736771129913784*^9, 3.736771233426057*^9, 
  3.7368025176364856`*^9},ExpressionUUID->"bd484be0-0149-4302-8e4f-\
dd6fc867959a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"(SysDir) System Directory: \"\>", 
   "\[InvisibleSpace]", \
"\<\"C:\\\\Users\\\\tmpra\\\\Dropbox\\\\nEDM\\\\system\"\>"}],
  SequenceForm[
  "(SysDir) System Directory: ", "C:\\Users\\tmpra\\Dropbox\\nEDM\\system"],
  Editable->False]], "Print",
 CellChangeTimes->{3.736771129913784*^9, 3.736771233426057*^9, 
  3.7368025176414814`*^9},ExpressionUUID->"fa967808-3c87-4dbb-984f-\
a2a279677c90"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Rawdata on mpc1636:\"\>", 
   "\[InvisibleSpace]", "\<\"/xdata/nedm_data/RawData\"\>"}],
  SequenceForm["Rawdata on mpc1636:", "/xdata/nedm_data/RawData"],
  Editable->False]], "Print",
 CellChangeTimes->{3.736771129913784*^9, 3.736771233426057*^9, 
  3.73680251764748*^9},ExpressionUUID->"8d3f1912-5f6e-4017-9317-c1f2f327224c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lomb Scargle", "Title",
 CellChangeTimes->{{3.736771225375641*^9, 
  3.7367712280081387`*^9}},ExpressionUUID->"b1ef6e34-c0e3-4a60-8ead-\
9b2d5a824893"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rundat", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"starttime", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pta10", "=", 
   RowBox[{"pta20", "=", 
    RowBox[{"fta10", "=", 
     RowBox[{"fta20", "=", 
      RowBox[{"erra10", "=", 
       RowBox[{"erra20", "=", 
        RowBox[{"fta102", "=", 
         RowBox[{"fta202", "=", 
          RowBox[{"{", "}"}]}]}]}]}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bpt10", "=", 
   RowBox[{"bft10", "=", 
    RowBox[{"errb10", "=", 
     RowBox[{"{", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bpt20", "=", 
   RowBox[{"bft20", "=", 
    RowBox[{"errb20", "=", 
     RowBox[{"{", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bpt0", "=", 
   RowBox[{"bft0", "=", 
    RowBox[{"errb0", "=", 
     RowBox[{"{", "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptarun", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "dimdesc"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"ptarun2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "dimdesc"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ftarun", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "dimdesc"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"ftarun2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "dimdesc"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"errarun", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "dimdesc"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"errarun2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "dimdesc"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsadd", "=", 
   RowBox[{"2", "*", 
    RowBox[{"PlusMinus", "[", 
     RowBox[{"11.306", ",", "0.397"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "dimdesc"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pmb0run", "=", 
       RowBox[{"pmbbrun", "=", 
        RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"descdat", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "5", "]"}], "]"}], ">", "20"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"descdat", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "5", "]"}], "]"}], "<", "9000"}]}], 
         RowBox[{"(*", 
          RowBox[{"&&", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "39", ",", 
               "40", ",", "41"}], "}"}], ",", "i"}], "]"}]}], "*)"}], ")"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"descdat", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rundat", "=", 
          RowBox[{"ReadList", "[", 
           RowBox[{
            RowBox[{"StringJoin", "[", 
             RowBox[{"AscDir", ",", "seperator", ",", 
              RowBox[{"IntegerString", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"descdat", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "4", "]"}], "]"}], ",", "10", ",", "6"}], "]"}],
               ",", "seperator", ",", 
              RowBox[{"IntegerString", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"descdat", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "4", "]"}], "]"}], ",", "10", ",", "6"}], "]"}],
               ",", "\"\<_lvl2.dat\>\""}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "Real", ",", "Real", ",", "Real", ",", "Real", ",", "Real", ",", 
              "Real", ",", "Real", ",", "Real", ",", "Real"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dimrundat", "=", 
          RowBox[{
           RowBox[{"Dimensions", "[", "rundat", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "1"}], ",", 
           RowBox[{"starttime", "=", 
            RowBox[{
             RowBox[{"rundat", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"For", "-", 
           RowBox[{"A", "*", 
            RowBox[{"tf", "/", "ts"}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ptarun", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "-", "starttime"}], ")"}], 
                "/", 
                RowBox[{"(", "86164.09054", ")"}]}], "]"}], 
              RowBox[{"(*", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "-", "starttime"}], ")"}],
                   "/", 
                  RowBox[{"(", "86164.09054", ")"}]}], ",", "1"}], "]"}], 
               "*)"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"PlusMinus", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ")"}], "*", 
                   RowBox[{"10", "^", "6"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"PlusMinus", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"descdat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "9", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"descdat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "10", "]"}], "]"}]}], "]"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"PlusMinus", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"descdat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "7", "]"}], "]"}], ",", "0.1"}], "]"}], "+", 
                    "tsadd"}], ")"}]}], ")"}]}], ")"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"PlusMinus", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ")"}], "*", 
                    RowBox[{"10", "^", "6"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"PlusMinus", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"descdat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "9", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"descdat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "10", "]"}], "]"}]}], "]"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"PlusMinus", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"descdat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "7", "]"}], "]"}], ",", "0.1"}], "]"}], "+", 
                    "tsadd"}], ")"}]}], ")"}]}], ")"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], 
               "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{
               RowBox[{"Dimensions", "[", 
                RowBox[{"rundat", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}], 
               "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ftarun", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"ptarun", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"ptarun", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "2"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"errarun", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ptarun", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "2"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"For", "-", "A"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ptarun2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "-", "starttime"}], ")"}], 
                "/", 
                RowBox[{"(", "86164.09054", ")"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"rundat", "[", 
                   RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{
               RowBox[{"Dimensions", "[", 
                RowBox[{"rundat", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}], 
               "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ftarun2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"ptarun2", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"ptarun2", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "2"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"errarun2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ptarun2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "2"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"descdat", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "6", "]"}], "]"}], "\[Equal]", "10"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"bpt10", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"bpt10", ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "1"}], "]"}], "]"}], "-", 
                    "starttime"}], ")"}], "/", 
                    RowBox[{"(", "86164.09054", ")"}]}], "]"}], ",", 
                   RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"{", 
                    RowBox[{"8", ",", "9"}], "}"}]}], "]"}], "]"}]}], "}"}], 
                 "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"bft10", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"bft10", ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "1"}], "]"}], "]"}], "-", 
                    "starttime"}], ")"}], "/", 
                    RowBox[{"(", "86164.09054", ")"}]}], "]"}], ",", 
                   RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "8"}], "]"}], "]"}]}], "}"}], "]"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"errb10", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"errb10", ",", 
                RowBox[{"rundat", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "9"}], "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"pmbbrun", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"pmbbrun", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"PlusMinus", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"rundat", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "8", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"rundat", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "9", "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "1", ",", "dimrundat"}], "}"}]}], 
                 "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", "A", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"pta10", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"pta10", ",", 
                RowBox[{"ptarun", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"fta10", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"fta10", ",", 
                RowBox[{"ftarun", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"erra10", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"erra10", ",", 
                RowBox[{"errarun", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"bpt20", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"bpt20", ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "1"}], "]"}], "]"}], "-", 
                    "starttime"}], ")"}], "/", 
                    RowBox[{"(", "86164.09054", ")"}]}], "]"}], ",", 
                   RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"{", 
                    RowBox[{"8", ",", "9"}], "}"}]}], "]"}], "]"}]}], "}"}], 
                 "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"bft20", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"bft20", ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "1"}], "]"}], "]"}], "-", 
                    "starttime"}], ")"}], "/", 
                    RowBox[{"(", "86164.09054", ")"}]}], "]"}], ",", 
                   RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "8"}], "]"}], "]"}]}], "}"}], "]"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"errb20", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"errb20", ",", 
                RowBox[{"rundat", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "9"}], "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"pmbbrun", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"pmbbrun", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"PlusMinus", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"rundat", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "8", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"rundat", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "9", "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "1", ",", "dimrundat"}], "}"}]}], 
                 "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", "A", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"pta20", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"pta20", ",", 
                RowBox[{"ptarun", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"fta20", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"fta20", ",", 
                RowBox[{"ftarun", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"erra20", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"erra20", ",", 
                RowBox[{"errarun", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"bpt0", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"bpt0", ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"N", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "1"}], "]"}], "]"}], "-", 
                   "starttime"}], ")"}], "/", 
                 RowBox[{"(", "86164.09054", ")"}]}], "]"}], ",", 
               RowBox[{"rundat", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", 
                  RowBox[{"{", 
                   RowBox[{"6", ",", "7"}], "}"}]}], "]"}], "]"}]}], "}"}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bft0", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"bft0", ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"N", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"rundat", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "1"}], "]"}], "]"}], "-", 
                   "starttime"}], ")"}], "/", 
                 RowBox[{"(", "86164.09054", ")"}]}], "]"}], ",", 
               RowBox[{"rundat", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "6"}], "]"}], "]"}]}], "}"}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"errb0", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"errb0", ",", 
            RowBox[{"rundat", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "7"}], "]"}], "]"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"lvl3", "=", 
       RowBox[{"{", 
        RowBox[{"{", "}"}], "}"}]}], ";"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"AscDir", ",", "seperator", ",", 
          RowBox[{"IntegerString", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"descdat", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", "10", ",", "6"}], "]"}], 
          ",", "seperator", ",", 
          RowBox[{"IntegerString", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"descdat", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", "10", ",", "6"}], "]"}], 
          ",", "\"\<_lvl3sidereal.dat\>\""}], "]"}], ",", "lvl3"}], "]"}], 
      ";"}], "*)"}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cutoff", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cleanpta10", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"pta10", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", "cutoff"}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cleanpta20", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"pta20", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
       RowBox[{"cutoff", "*", "1.5"}]}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cleanfta10", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"cleanpta10", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"cleanpta10", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "cleanpta10", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cleanerra10", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"cleanpta10", "[", 
        RowBox[{"[", "k", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "cleanpta10", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cleanfta20", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"cleanpta20", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"cleanpta20", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "cleanpta20", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cleanerra20", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"cleanpta20", "[", 
        RowBox[{"[", "k", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "cleanpta20", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7293292855481405`*^9, 3.7293292918035803`*^9}, {
   3.729329345144373*^9, 3.7293293454465885`*^9}, {3.729329390299404*^9, 
   3.7293297278463964`*^9}, {3.7293300264021044`*^9, 
   3.7293300422535896`*^9}, {3.7293305830297165`*^9, 3.729330586023738*^9}, {
   3.7293306217067366`*^9, 3.729330641162341*^9}, {3.729330686745142*^9, 
   3.7293309502144475`*^9}, {3.729331044320679*^9, 3.7293310784660025`*^9}, {
   3.729331157831172*^9, 3.729331220392955*^9}, {3.729331376352108*^9, 
   3.7293313895058966`*^9}, {3.7293314218293047`*^9, 3.729331525789362*^9}, {
   3.7293315684307537`*^9, 3.7293316550813775`*^9}, {3.729331737940843*^9, 
   3.7293317697427826`*^9}, {3.729331936750059*^9, 3.7293319577269363`*^9}, {
   3.7293330849311805`*^9, 3.7293333197029247`*^9}, {3.7293333787913227`*^9, 
   3.729333386603862*^9}, {3.729334154024156*^9, 3.729334154674249*^9}, {
   3.729335015215966*^9, 3.7293351262916718`*^9}, {3.729335502607174*^9, 
   3.729335528720346*^9}, {3.729335565916687*^9, 3.72933561239244*^9}, 
   3.7293357713129363`*^9, {3.729336264224887*^9, 3.729336268909337*^9}, {
   3.729338023152836*^9, 3.729338023450096*^9}, {3.7293388262094545`*^9, 
   3.7293388500469313`*^9}, {3.729339521672391*^9, 3.729339530071594*^9}, {
   3.729339640606465*^9, 3.729339655336752*^9}, {3.7293399576425767`*^9, 
   3.7293399675579433`*^9}, {3.7293400394482374`*^9, 
   3.7293400469481463`*^9}, {3.7293402118621483`*^9, 
   3.7293402423722677`*^9}, {3.7293417252264285`*^9, 3.7293417470063343`*^9}, 
   3.729341996194191*^9, 3.7294395779312344`*^9, {3.7294396647791185`*^9, 
   3.7294396796261663`*^9}, 3.7294461681626596`*^9, {3.7294464144081173`*^9, 
   3.7294464147093306`*^9}, {3.729456082117285*^9, 3.7294561176894016`*^9}, {
   3.7294567860550675`*^9, 3.729456819851651*^9}, {3.7367714929116783`*^9, 
   3.736771493161522*^9}, {3.736771577013591*^9, 3.7367715900860987`*^9}, {
   3.7367716986720266`*^9, 3.736771740388155*^9}, {3.736771794171398*^9, 
   3.7367717951568365`*^9}, {3.7367814687388563`*^9, 
   3.7367815030522494`*^9}, {3.736782977517235*^9, 
   3.736783032485803*^9}},ExpressionUUID->"54509ae0-d7e0-4a6f-9248-\
4548ea3d06b0"],

Cell[CellGroupData[{

Cell["MC+LS", "Chapter",
 CellChangeTimes->{{3.7367724284268727`*^9, 
  3.736772429822076*^9}},ExpressionUUID->"7011e539-fa08-419d-b618-\
98d74dcd0e1f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mcruns", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"np", "=", "2000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gramftamc", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "mcruns"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gramftamc2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "mcruns"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"totdat", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"cleanpta10", ",", "cleanpta20"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"totdatft", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"cleanfta10", ",", "cleanfta20"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Parallelize", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "\[LessEqual]", "mcruns"}], ",", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cleanftamc", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{
           RowBox[{"Dimensions", "[", "totdat", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"RandomSeed", "[", 
           RowBox[{"CurrentDate", "[", "]"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cleanftamc", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"cleanftamc", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"totdat", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"RandomVariate", "[", 
                RowBox[{"NormalDistribution", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"totdat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"totdat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gramftamc", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "=", 
        RowBox[{"LS", "[", 
         RowBox[{"cleanftamc", ",", "np"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gramftamc2", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "=", 
        RowBox[{"LSCos", "[", 
         RowBox[{"cleanftamc", ",", "np"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"gramfta", "=", 
     RowBox[{"LS", "[", 
      RowBox[{"totdatft", ",", "np"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"gramfta2", "=", 
     RowBox[{"LSCos", "[", 
      RowBox[{"totdatft", ",", "np"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"gramftamcm", "=", 
     RowBox[{"Mean", "[", "gramftamc", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"gramftamcm2", "=", 
     RowBox[{"Mean", "[", "gramftamc2", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"gramftamcs", "=", 
     RowBox[{"StandardDeviation", "[", "gramftamc", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"gramftamcs2", "=", 
     RowBox[{"StandardDeviation", "[", "gramftamc2", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.7367724242502613`*^9, 3.7367724815075226`*^9}, {
  3.7367726536144924`*^9, 3.7367726620496674`*^9}, {3.736775692491872*^9, 
  3.7367756975549574`*^9}, {3.736779930826795*^9, 3.7367799325977736`*^9}, {
  3.736781013001732*^9, 3.736781017815962*^9}, {3.7367829400396852`*^9, 
  3.73678294358064*^9}, {3.7367971503825736`*^9, 3.7367971507583575`*^9}, {
  3.736798508026468*^9, 
  3.7367985321915817`*^9}},ExpressionUUID->"f00ca1fd-7625-46c6-9fb9-\
613b370a37af"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2509.781957798098`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.736772443976981*^9, 3.7367737865962763`*^9, 
  3.7367754769312215`*^9, 3.7367767895279675`*^9, 3.7367809966512012`*^9, 
  3.7367829367755327`*^9, 3.7367971475218916`*^9, 3.7367982184401884`*^9, 
  3.7368010431112604`*^9},ExpressionUUID->"1a4851ef-bae3-4832-914d-\
03445903efce"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Dump", " ", "Old", " ", "data", " ", "set"}], "*)"}]], "Input",
 CellChangeTimes->{{3.736802250551862*^9, 
  3.736802262135233*^9}},ExpressionUUID->"fc3a3089-f13a-4892-bb0c-\
1860cda6ea57"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{"descDir", ",", "seperator", ",", "\"\<LS-Sin-data.dat\>\""}], 
    "]"}], ",", "gramfta"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{"descDir", ",", "seperator", ",", "\"\<LS-Cos-data.dat\>\""}], 
    "]"}], ",", "gramfta2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{"descDir", ",", "seperator", ",", "\"\<LS-Sin-mc_mean.dat\>\""}], 
    "]"}], ",", "gramftamcm"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{"descDir", ",", "seperator", ",", "\"\<LS-Cos-mc_mean.dat\>\""}], 
    "]"}], ",", "gramftamcm2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{"descDir", ",", "seperator", ",", "\"\<LS-Sin-mc_sigma.dat\>\""}],
     "]"}], ",", "gramftamcs"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{"descDir", ",", "seperator", ",", "\"\<LS-Cos-mc_sigma.dat\>\""}],
     "]"}], ",", "gramftamcs2"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.736773340929567*^9, 3.7367799700163407`*^9, {3.7368017997745776`*^9, 
   3.7368018911482844`*^9}, {3.736801924606938*^9, 3.7368019341924644`*^9}, {
   3.7368021730688133`*^9, 
   3.736802237160447*^9}},ExpressionUUID->"d68963de-f362-48a7-b40e-\
fa05fa18ce0b"],

Cell[BoxData["\<\"C:\\\\Users\\\\tmpra\\\\Dropbox\\\\nEDM\\\\analysis-mirror_\
neutrons\\\\nstar_online\\\\LS-Sin-data.dat\"\>"], "Output",
 CellChangeTimes->{
  3.736802380567513*^9},ExpressionUUID->"ef0fdcdf-c359-4cc7-821c-\
4b37e68bd65a"],

Cell[BoxData["\<\"C:\\\\Users\\\\tmpra\\\\Dropbox\\\\nEDM\\\\analysis-mirror_\
neutrons\\\\nstar_online\\\\LS-Cos-data.dat\"\>"], "Output",
 CellChangeTimes->{
  3.7368023812581177`*^9},ExpressionUUID->"2a522b9d-2a34-4abf-af1e-\
6d5f2d90c183"],

Cell[BoxData["\<\"C:\\\\Users\\\\tmpra\\\\Dropbox\\\\nEDM\\\\analysis-mirror_\
neutrons\\\\nstar_online\\\\LS-Sin-mc_mean.dat\"\>"], "Output",
 CellChangeTimes->{
  3.7368023819752083`*^9},ExpressionUUID->"c4216cfc-5cce-428b-b17e-\
ea3aadb190c7"],

Cell[BoxData["\<\"C:\\\\Users\\\\tmpra\\\\Dropbox\\\\nEDM\\\\analysis-mirror_\
neutrons\\\\nstar_online\\\\LS-Cos-mc_mean.dat\"\>"], "Output",
 CellChangeTimes->{
  3.7368023826030407`*^9},ExpressionUUID->"6a5e1cd6-9435-4193-8376-\
7713a149ab03"],

Cell[BoxData["\<\"C:\\\\Users\\\\tmpra\\\\Dropbox\\\\nEDM\\\\analysis-mirror_\
neutrons\\\\nstar_online\\\\LS-Sin-mc_sigma.dat\"\>"], "Output",
 CellChangeTimes->{
  3.7368023830711155`*^9},ExpressionUUID->"40379f9f-71f0-404f-9f81-\
c011538c617a"],

Cell[BoxData["\<\"C:\\\\Users\\\\tmpra\\\\Dropbox\\\\nEDM\\\\analysis-mirror_\
neutrons\\\\nstar_online\\\\LS-Cos-mc_sigma.dat\"\>"], "Output",
 CellChangeTimes->{
  3.7368023835188665`*^9},ExpressionUUID->"1e0f23eb-b00d-4c5b-8fd0-\
fd5173a3a0c0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"DO", " ", "NOT", " ", "RUN", " ", "Usually"}], ",", " ", 
   RowBox[{"Loading", " ", "old", " ", "data", " ", "set"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7368022736096897`*^9, 
  3.7368022844105124`*^9}},ExpressionUUID->"3c6bf6ba-f4f9-45e5-be98-\
fa53fe35c690"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gramfta", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"descDir", ",", "seperator", ",", "\"\<LS-Sin-data.dat\>\""}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gramfta2", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"descDir", ",", "seperator", ",", "\"\<LS-Cos-data.dat\>\""}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gramftamcm", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"descDir", ",", "seperator", ",", "\"\<LS-Sin-mc_mean.dat\>\""}],
      "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gramftamcm2", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"descDir", ",", "seperator", ",", "\"\<LS-Cos-mc_mean.dat\>\""}],
      "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gramftamcs", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
     "descDir", ",", "seperator", ",", "\"\<LS-Sin-mc_sigma.dat\>\""}], "]"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gramftamcs2", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
     "descDir", ",", "seperator", ",", "\"\<LS-Cos-mc_sigma.dat\>\""}], "]"}],
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7368023025241385`*^9, 3.736802377630196*^9}, {
  3.736802422563219*^9, 
  3.7368024580589027`*^9}},ExpressionUUID->"7a8e6fd8-e733-4987-a01a-\
8464bff03308"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 877},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 24871, 627, 1695, "Input",ExpressionUUID->"dea71d71-bbcb-4ca1-8a1a-83833dbb0201"],
Cell[CellGroupData[{
Cell[25476, 653, 499, 12, 22, "Print",ExpressionUUID->"1fc9330f-9a02-4b95-9c7e-0dc5556c1926"],
Cell[25978, 667, 447, 10, 22, "Print",ExpressionUUID->"c35cb713-cbe4-437d-851c-90d207c657a2"],
Cell[26428, 679, 429, 9, 22, "Print",ExpressionUUID->"980cc5c7-6a1a-4251-b1b7-1f799ed1259c"],
Cell[26860, 690, 487, 12, 22, "Print",ExpressionUUID->"bd484be0-0149-4302-8e4f-dd6fc867959a"],
Cell[27350, 704, 443, 10, 22, "Print",ExpressionUUID->"fa967808-3c87-4dbb-984f-a2a279677c90"],
Cell[27796, 716, 377, 7, 22, "Print",ExpressionUUID->"8d3f1912-5f6e-4017-9317-c1f2f327224c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28222, 729, 157, 3, 96, "Title",ExpressionUUID->"b1ef6e34-c0e3-4a60-8ead-9b2d5a824893"],
Cell[28382, 734, 32652, 818, 1492, "Input",ExpressionUUID->"54509ae0-d7e0-4a6f-9248-4548ea3d06b0"],
Cell[CellGroupData[{
Cell[61059, 1556, 152, 3, 67, "Chapter",ExpressionUUID->"7011e539-fa08-419d-b618-98d74dcd0e1f"],
Cell[CellGroupData[{
Cell[61236, 1563, 4616, 115, 447, "Input",ExpressionUUID->"f00ca1fd-7625-46c6-9fb9-613b370a37af"],
Cell[65855, 1680, 393, 7, 32, "Output",ExpressionUUID->"1a4851ef-bae3-4832-914d-03445903efce"]
}, Open  ]],
Cell[66263, 1690, 230, 5, 28, "Input",ExpressionUUID->"fc3a3089-f13a-4892-bb0c-1860cda6ea57"],
Cell[CellGroupData[{
Cell[66518, 1699, 1532, 36, 124, "Input",ExpressionUUID->"d68963de-f362-48a7-b40e-fa05fa18ce0b"],
Cell[68053, 1737, 241, 4, 32, "Output",ExpressionUUID->"ef0fdcdf-c359-4cc7-821c-4b37e68bd65a"],
Cell[68297, 1743, 243, 4, 32, "Output",ExpressionUUID->"2a522b9d-2a34-4abf-af1e-6d5f2d90c183"],
Cell[68543, 1749, 246, 4, 32, "Output",ExpressionUUID->"c4216cfc-5cce-428b-b17e-ea3aadb190c7"],
Cell[68792, 1755, 246, 4, 32, "Output",ExpressionUUID->"6a5e1cd6-9435-4193-8376-7713a149ab03"],
Cell[69041, 1761, 247, 4, 32, "Output",ExpressionUUID->"40379f9f-71f0-404f-9f81-c011538c617a"],
Cell[69291, 1767, 247, 4, 32, "Output",ExpressionUUID->"1e0f23eb-b00d-4c5b-8fd0-fd5173a3a0c0"]
}, Open  ]],
Cell[69553, 1774, 324, 8, 28, "Input",ExpressionUUID->"3c6bf6ba-f4f9-45e5-be98-fa53fe35c690"],
Cell[69880, 1784, 1569, 42, 124, "Input",ExpressionUUID->"7a8e6fd8-e733-4987-a01a-8464bff03308"]
}, Open  ]]
}, Open  ]]
}
]
*)

